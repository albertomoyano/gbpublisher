' Gambas module file

Private ContenidoOT As Result
Private id_proyecto As Integer

Public Function CargarMetadatosDelProyecto() As Boolean

  Dim sSQL As String

  ' Buscar en tabla metadatos
  sSQL = "SELECT * FROM orden_taller WHERE id_proyecto = &1"
  ContenidoOT = m_ConexionBD.mConn.Exec(sSQL, FMain.id_proyecto.Value)

  ' If Contenido.Available Then
  '   ' Asignación directa (si usas VARCHAR NOT NULL DEFAULT '')
  '   With FMain
  '     .txtNombreRevista.Text = Contenido["nombre"]
  '     .txtImagenTapita.Text = Contenido["imagen_tapita"]
  '     .txtRevistaTitulo.Text = Contenido["titulo"]
  '     .txtRevistaAbreviatura.Text = Contenido["abreviatura"]
  '     .txtRevistaDOIPrefix.Text = Contenido["doi_prefix"]
  '     .txtRevistaISSN.Text = Contenido["issn"]
  '     .txtRevistaVolumen.Text = Contenido["volumen"]
  '     .txtRevistaNumero.Text = Contenido["numero"]
  '     .txtRevistaAnio.Text = Contenido["anio"]
  '     .txtRevistaMes.Text = Contenido["mes"]
  '     .txtRevistaEditor.Text = Contenido["editor"]
  '     .txtRevistaEditorial.Text = Contenido["editorial"]
  '     .txtRevistaPais.Text = Contenido["pais"]
  '     .txtRevistaIdioma.Text = Contenido["idioma"]
  '     .txtRevistaFrecuencia.Text = Contenido["frecuencia"]
  '     .txtRevistaURL.Text = Contenido["url"]
  '     .txtRevistaEmail.Text = Contenido["email"]
  '     ' ... continúa con los demás
  '
  '     ' Para ComboBox
  '     If Not IsNull(Contenido["autoria_libro_index"]) Then
  '       .cmbAutoriaLibro.Index = Contenido["autoria_libro_index"]
  '     Endif
  '
  '     .txtGhpFooter.Text = Contenido["ghp_footer"]
  '   End With
  '
  '   Return True
  ' Else
  '   m_Sonido.sonar("Warning")
  '   Message.Warning("No se encontraron metadatos para este proyecto.")
  '   Return False
  ' Endif

Catch
  m_Sonido.sonar("Error")
  Message.Error("Error al cargar metadatos: " & Error.Text)
  Return False

End