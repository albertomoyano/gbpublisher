' Gambas class file

' FORMULARIO PARA INGRESAR EL MENSAJE DE COMMIT

' VARIABLE ESTÁTICA PARA ALMACENAR EL MENSAJE DE COMMIT
' SE USA STATIC PARA QUE PERSISTA DESPUÉS DE CERRAR EL FORMULARIO
' YA QUE LAS VARIABLES PUBLIC SE PIERDEN AL EJECUTAR ME.CLOSE()
Static Public MensajeCommit As String

Public Sub btnEmpujar_Click()
  ' VALIDAR QUE EL TEXTAREA NO ESTÉ VACÍO

  If Trim(txtCommit.Text) = "" Then
    m_Sonido.sonar("Error")
    Message.Error("Debe escribir un mensaje para el commit", "Ok")
    Return
  Endif

  ' GUARDAR EL MENSAJE DE COMMIT EN LA VARIABLE ESTÁTICA
  ' ESTO SE HACE ANTES DE CERRAR PARA QUE EL VALOR PERSISTA
  MensajeCommit = Trim(txtCommit.Text)

  ' CERRAR EL FORMULARIO DEVOLVIENDO TRUE (1) PARA INDICAR ÉXITO
  Me.Close(True)

End

Public Sub btnCancelar_Click()
  ' LIMPIAR LA VARIABLE ESTÁTICA AL CANCELAR

  MensajeCommit = ""
  ' CERRAR EL FORMULARIO DEVOLVIENDO FALSE (0) PARA INDICAR CANCELACIÓN
  Me.Close(False)

End

Public Sub Form_Open()
  ' LIMPIAR EL TEXTAREA AL ABRIR EL FORMULARIO

  txtCommit.Text = ""
  ' CENTRAR EL FORMULARIO
  Me.Center()
  ' DAR FOCO AL TEXTAREA
  txtCommit.SetFocus()

End