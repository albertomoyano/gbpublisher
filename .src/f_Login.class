' Gambas class file

Public Sub Form_Open()

  CargarComboBoxIP()

End

' Método para recargar solo el ComboBox (extraído del Form_Open)
Public Sub CargarComboBoxIP()

  Dim rutaIPs As String = User.Home &/ ".gbpublisher/ips.txt"
  Dim contenidoArchivo As String
  Dim linea As String
  Dim contenido As String[]

  ComboBoxIP.Clear()

  If Not Exist(rutaIPs) Then Return

  Try contenidoArchivo = File.Load(rutaIPs)
  If Error Then
    Message.Error("No se pudo leer el archivo de IPs: " & Error.Text)
    Return
  End If

  ' Normaliza saltos de línea (Windows/Linux)
  contenidoArchivo = Replace(contenidoArchivo, "\r\n", "\n")
  contenido = Split(contenidoArchivo, "\n")

  For Each linea In contenido
    linea = Trim(linea)
    If linea <> "" Then
      ComboBoxIP.Add(linea)
    End If
  Next

End

Public Sub btnEditarIPs_Click()

  f_EditarIPs.ShowModal()

  ' Refrescar el ComboBox inmediatamente después de cerrar el modal
  m_FuncionesGenericas.CargarComboBoxIP(ComboBoxIP)

End

Public Sub btnCancelar_Click()

  Me.Close

End
