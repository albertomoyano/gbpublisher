' Gambas class file

Public Sub Form_Open()

  ' Refrescar el ComboBox inmediatamente después de cerrar el modal
  m_FuncionesGenericas.CargarComboBoxIP(ComboBoxIP)

End

Public Sub btnEditarIPs_Click()

  f_EditarIPs.ShowModal()

  ' Refrescar el ComboBox inmediatamente después de cerrar el modal
  m_FuncionesGenericas.CargarComboBoxIP(ComboBoxIP)

End

Public Sub btnCancelar_Click()

  Me.Close

End

Public Sub ToggleButtonMostrar_Click()

  ' Invertimos la lógica: mostrar caracteres si el botón está activado
  If ToggleButtonMostrar.Value Then
    TextBoxClave.Password = False  ' Mostrar texto
  Else
    TextBoxClave.Password = True   ' Ocultar texto
  Endif

  ' Forzar redibujado y mantener el foco correctamente
  TextBoxClave.Refresh()
  TextBoxClave.SetFocus()

End

Public Sub btnConectarServer_Click()

  ' Si el login es correcto habilitamos los botones
  FMain.MenuInicio.Visible = True ' habilitamos el menu del formulario
  FMain.ButtonCerrarApp.Visible = False
  FMain.TextBoxUsuario.Text = "alberto"
  FMain.TextBoxServidor.Text = "127.0.0.1"
  FMain.ButtonEmail.Enabled = True
  FMain.ButtonNotitas.Enabled = True
  FMain.ButtonBitacora.Enabled = True
  FMain.ButtonBolckNotas.Enabled = True
  FMain.ButtonAdminRepositorios.Enabled = True
  FMain.ButtonConsultasSQL.Enabled = True
  FMain.ButtonCorregirBib.Enabled = True
  '
  Me.Close

End
