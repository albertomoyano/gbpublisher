' Gambas class file

Private Contenido As Result

Public Sub Form_Activate()

  CargarNotas()

End

Public Sub Form_Open()

  CargarNotas()

  With TableViewEstadisticas
    .Header = True
    .Grid = True
    .Columns.Count = 62

    ' Configuración de columnas
    For i As Integer = 0 To 61
      Select Case i
        Case 0
          .Columns[i].Title = "id"
          .Columns[i].Width = 80
        Case 1
          .Columns[i].Title = "Proyecto"
          .Columns[i].Width = 800
        Case Else
          .Columns[i].Title = ""
          .Columns[i].Width = 0
      End Select
    Next
  End With

End

' Función para cargar y actualizar la grilla
Public Sub CargarNotas()

  Contenido = m_OnOff_y_Red.meConn.Exec("SELECT * FROM revistas ORDER BY id DESC")
  TableViewEstadisticas.Rows.Count = Contenido.Count
  TableViewEstadisticas.Refresh()

End

Public Sub Button3Estadisticas_Click()

  Me.Close

End

Public Sub Form_Close()

  Me.Close

End

Public Sub TableViewEstadisticas_Data(Row As Integer, Column As Integer)

  If (Contenido <> Null) Then
    If Row >= 0 Then
      Contenido.moveTo(Row)
      Try TableViewEstadisticas.Data.Text = Str(Contenido[Column])
    Endif
  Endif

End

Public Sub CargarDatos(Consulta As String, Grid As GridView)

  Dim i As Integer

  ' Ejecutar la consulta
  Contenido = m_OnOff_y_Red.meConn.Exec(Consulta)

  ' Si no hay resultados
  If Contenido.Count = 0 Then
    Message.Info("No se ha encontrado ningún resultado.")
    Return
  Endif

  ' Limpiar el Grid antes de mostrar los resultados
  Grid.Clear()
  Grid.Rows.Count = Contenido.Count

  ' Llenar el Grid con los resultados
  For i = 0 To Contenido.Count - 1
    For j As Integer = 0 To Grid.Columns.Count - 1
      Grid[i, j].Text = Contenido[j]
    Next
    Contenido.MoveNext
  Next

End
