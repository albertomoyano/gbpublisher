' Gambas module file

Public Sub CargarTodosLosComboBox()
  ' CARGA TODOS LOS COMBOBOX DE ARCHIVOS DEL PROYECTO
  ' CENTRALIZA LAS LLAMADAS PARA EVITAR OLVIDOS

  CargarListaArchivosXML()

End

Public Sub CargarListaArchivosXML()
  ' CARGA LA LISTA DE ARCHIVOS XML DISPONIBLES EN EL DIRECTORIO DE SALIDAS
  ' LLENA EL COMBOBOX cmbArchivosXML CON LOS ARCHIVOS ENCONTRADOS

  Dim sRutaXML As String
  Dim aArchivos As String[]
  Dim sArchivo As String

  ' LIMPIAR EL COMBOBOX
  FMain.cmbArchivosXML.Clear()

  ' CONSTRUIR RUTA A LA CARPETA DE SALIDAS XML
  sRutaXML = FMain.RutaProyecto &/ "jats"

  ' VERIFICAR QUE EL DIRECTORIO EXISTE
  If Not IsDir(sRutaXML) Then
    Return
  Endif

  ' LISTAR ARCHIVOS .XML EN LA CARPETA
  aArchivos = Dir(sRutaXML, "*.xml")

  ' VERIFICAR QUE HAY ARCHIVOS
  If aArchivos.Count = 0 Then
    Return
  Endif

  ' ORDENAR ALFABÃ‰TICAMENTE
  aArchivos.Sort()

  ' AGREGAR CADA ARCHIVO AL COMBOBOX
  For Each sArchivo In aArchivos
    FMain.cmbArchivosXML.Add(sArchivo)
  Next

  ' SELECCIONAR EL PRIMER ARCHIVO POR DEFECTO
  FMain.cmbArchivosXML.Index = 0

End
