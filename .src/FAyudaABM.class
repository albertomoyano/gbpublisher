' Gambas class file

' ============================================
' FORMULARIO: FAyudaABM
' DESCRIPCIÓN: ABM (Alta, Baja, Modificación) para el sistema de ayudas contextuales multiidioma
' AUTOR: Alberto Moyano
' FECHA: 2026
' ============================================

' ============================================
' VARIABLES GLOBALES PRIVADAS
' ============================================
Private $modoEdicion As Boolean = False ' TRUE = editando ayuda existente, FALSE = creando nueva
Private $componenteOriginal As String   ' Guarda el nombre del componente en edición para detectar cambios
Private $datosOriginales As Collection  ' Almacena los datos originales para la función Cancelar
Private $usuarioActual As String        ' Usuario autenticado que opera el formulario

' ============================================
' EVENTO: APERTURA DEL FORMULARIO
' DESCRIPCIÓN: Se ejecuta cuando se abre el formulario
' ACCIONES:
'   - Obtiene el usuario actual del módulo de inicio
'   - Configura el título del formulario
'   - Carga las tablas disponibles
'   - Inicializa el formulario en estado limpio
'   - Configura las propiedades de las TextAreas
' ============================================
Public Sub Form_Open()

  ' OBTENER USUARIO ACTUAL DEL MÓDULO DE INICIO
  $usuarioActual = m_InicioCierre.UsuarioEnCurso

  ' CONFIGURAR TÍTULO DEL FORMULARIO CON NOMBRE DE USUARIO
  Me.Title = "ABM de Ayudas - Usuario: " & $usuarioActual

  ' INICIALIZAR FORMULARIO
  CargarTablas()
  LimpiarFormulario()
  HabilitarControles(False)
  ConfigurarTextAreas()

End

' ============================================
' FUNCIÓN: CargarTablas
' DESCRIPCIÓN: Carga todas las tablas de la base de datos en el ComboBox
' PARÁMETROS: Ninguno
' RETORNA: Nada
' ACCIONES:
'   - Consulta INFORMATION_SCHEMA.TABLES para obtener las tablas
'   - Filtra solo las tablas base (no vistas)
'   - Ordena alfabéticamente
'   - Llena el ComboBox cmbTablas
' ============================================
Private Sub CargarTablas()

  Dim r As Result
  Dim sql As String

  ' LIMPIAR COMBOBOX
  cmbTablas.Clear()

  ' CONSULTA SQL PARA OBTENER TABLAS
  sql = "SELECT TABLE_NAME " &
    "FROM INFORMATION_SCHEMA.TABLES " &
    "WHERE TABLE_SCHEMA = DATABASE() " &
    "  AND TABLE_TYPE = 'BASE TABLE' " &
    "ORDER BY TABLE_NAME;"

  ' EJECUTAR CONSULTA
  Try r = m_ConexionBD.mConn.Exec(sql)

  ' MANEJO DE ERRORES
  If Error Then
    m_Sonido.sonar("Error")
    Message.Error("Error al cargar las tablas:\n" & Error.Text)
    Return
  Endif

  ' LLENAR COMBOBOX CON LOS RESULTADOS
  For Each r
    cmbTablas.Add(r!TABLE_NAME)
  Next

End

' ============================================
' EVENTO: cmbTablas_Click
' DESCRIPCIÓN: Se ejecuta cuando el usuario selecciona una tabla
' ACCIONES:
'   - Limpia el ComboBox de columnas
'   - Limpia los datos del formulario
'   - Carga las columnas de la tabla seleccionada
' ============================================
Public Sub cmbTablas_Click()

  ' VALIDAR QUE HAY SELECCIÓN
  If cmbTablas.Index < 0 Then Return

  ' LIMPIAR COLUMNAS Y DATOS
  cmbColumnas.Clear()
  LimpiarDatos()

  ' CARGAR COLUMNAS DE LA TABLA SELECCIONADA
  CargarColumnas(cmbTablas.Text)

End

' ============================================
' FUNCIÓN: CargarColumnas
' DESCRIPCIÓN: Carga las columnas de una tabla específica, ordenadas alfabéticamente
' PARÁMETROS:
'   nombreTabla (String): Nombre de la tabla de la cual cargar las columnas
' RETORNA: Nada
' ACCIONES:
'   - Consulta INFORMATION_SCHEMA.COLUMNS
'   - Ordena las columnas alfabéticamente (no por posición ordinal)
'   - Llena el ComboBox cmbColumnas
'   - Habilita el ComboBox de columnas
' ============================================
Private Sub CargarColumnas(nombreTabla As String)

  Dim r As Result
  Dim sql As String

  ' VALIDAR PARÁMETRO
  If Not nombreTabla Or Trim(nombreTabla) = "" Then Return

  ' LIMPIAR COMBOBOX
  cmbColumnas.Clear()

  ' CONSULTA SQL PARA OBTENER COLUMNAS ORDENADAS ALFABÉTICAMENTE
  sql = "SELECT COLUMN_NAME " &
    "FROM INFORMATION_SCHEMA.COLUMNS " &
    "WHERE TABLE_SCHEMA = DATABASE() " &
    "  AND TABLE_NAME = &1 " &
    "ORDER BY COLUMN_NAME;"

  ' EJECUTAR CONSULTA CON PARÁMETRO
  Try r = m_ConexionBD.mConn.Exec(sql, nombreTabla)

  ' MANEJO DE ERRORES
  If Error Then
    m_Sonido.sonar("Error")
    Message.Error("Error al cargar las columnas:\n" & Error.Text)
    Return
  Endif

  ' LLENAR COMBOBOX CON LOS RESULTADOS
  For Each r
    cmbColumnas.Add(r!COLUMN_NAME)
  Next

  ' HABILITAR COMBOBOX DE COLUMNAS PARA SELECCIÓN
  cmbColumnas.Enabled = True

End

' ============================================
' EVENTO: cmbColumnas_Click
' DESCRIPCIÓN: Se ejecuta cuando el usuario selecciona una columna
' ACCIONES:
'   - Autocompleta el campo txtComponente con el nombre de la columna
'   - Intenta cargar ayudas existentes para ese componente
'   - Habilita los controles de edición
' ============================================
Public Sub cmbColumnas_Click()

  Dim nombreColumna As String

  ' VALIDAR QUE HAY SELECCIÓN
  If cmbColumnas.Index < 0 Then Return

  ' OBTENER NOMBRE DE COLUMNA SELECCIONADA
  nombreColumna = cmbColumnas.Text

  ' VALIDAR QUE EL NOMBRE NO ESTÁ VACÍO
  If Not nombreColumna Or Trim(nombreColumna) = "" Then
    Message.Error("Error: No se pudo obtener el nombre de la columna.")
    Return
  Endif

  ' AUTOCOMPLETAR CAMPO COMPONENTE CON EL NOMBRE DE LA COLUMNA
  txtComponente.Text = nombreColumna

  ' INTENTAR CARGAR AYUDA EXISTENTE PARA ESTE COMPONENTE
  CargarAyudaExistente(nombreColumna)

  ' HABILITAR CONTROLES DE EDICIÓN
  HabilitarControles(True)

End

' ============================================
' FUNCIÓN: CargarAyudaExistente
' DESCRIPCIÓN: Busca y carga las ayudas existentes para un componente específico
' PARÁMETROS:
'   nombreComponente (String): Nombre del componente (campo de tabla)
' RETORNA: Nada
' ACCIONES:
'   - Busca en la tabla manual_ayudas registros para el componente
'   - Si encuentra datos, llena los TextAreas con las ayudas de cada idioma
'   - Si encuentra datos, activa el modo edición
'   - Si NO encuentra datos, activa el modo nuevo
' ============================================
Private Sub CargarAyudaExistente(nombreComponente As String)

  Dim r As Result
  Dim sql As String
  Dim hayDatos As Boolean = False

  ' VALIDAR PARÁMETRO
  If Not nombreComponente Or Trim(nombreComponente) = "" Then Return

  ' CONSULTA SQL PARA BUSCAR AYUDAS EXISTENTES
  sql = "SELECT idioma, clave, ayuda, usuario_creacion, fecha_creacion, " &
    "       usuario_modificacion, fecha_modificacion " &
    "FROM manual_ayudas " &
    "WHERE componente = &1;"

  ' EJECUTAR CONSULTA
  Try r = m_ConexionBD.mConn.Exec(sql, nombreComponente)

  ' MANEJO DE ERRORES
  If Error Then
    m_Sonido.sonar("Error")
    Message.Error("Error al buscar ayuda existente:\n" & Error.Text)
    Return
  Endif

  ' LIMPIAR SOLO LOS CAMPOS EDITABLES (NO EL COMPONENTE QUE YA ESTÁ ASIGNADO)
  txtClave.Text = ""
  txtAyudaES.Text = ""
  txtAyudaPT.Text = ""
  txtAyudaEN.Text = ""
  txtAyudaIT.Text = ""
  txtAyudaFR.Text = ""
  txtAyudaDE.Text = ""

  ' PROCESAR RESULTADOS POR IDIOMA
  For Each r
    hayDatos = True

    ' CARGAR CLAVE (ES LA MISMA PARA TODOS LOS IDIOMAS, SOLO SE CARGA UNA VEZ)
    If Not txtClave.Text Then
      txtClave.Text = r!clave
    Endif

    ' CARGAR AYUDA SEGÚN EL IDIOMA CORRESPONDIENTE
    Select Case r!idioma
      Case "es"
        txtAyudaES.Text = r!ayuda
      Case "pt"
        txtAyudaPT.Text = r!ayuda
      Case "en"
        txtAyudaEN.Text = r!ayuda
      Case "it"
        txtAyudaIT.Text = r!ayuda
      Case "fr"
        txtAyudaFR.Text = r!ayuda
      Case "de"
        txtAyudaDE.Text = r!ayuda
    End Select
  Next

  ' CONFIGURAR MODO DE OPERACIÓN SEGÚN SI HAY DATOS
  If hayDatos Then
    ' MODO EDICIÓN: Modificando ayuda existente
    $modoEdicion = True
    $componenteOriginal = nombreComponente
    GuardarDatosOriginales()
  Else
    ' MODO NUEVO: Creando nueva ayuda
    $modoEdicion = False
    $componenteOriginal = ""
  Endif

End

' ============================================
' FUNCIÓN: GuardarDatosOriginales
' DESCRIPCIÓN: Guarda los datos actuales del formulario en una colección
' PARÁMETROS: Ninguno
' RETORNA: Nada
' USO: Permite restaurar los datos con la función Cancelar
' ============================================
Private Sub GuardarDatosOriginales()

  ' CREAR NUEVA COLECCIÓN
  $datosOriginales = New Collection

  ' GUARDAR TODOS LOS CAMPOS EDITABLES
  $datosOriginales["clave"] = txtClave.Text
  $datosOriginales["es"] = txtAyudaES.Text
  $datosOriginales["pt"] = txtAyudaPT.Text
  $datosOriginales["en"] = txtAyudaEN.Text
  $datosOriginales["it"] = txtAyudaIT.Text
  $datosOriginales["fr"] = txtAyudaFR.Text
  $datosOriginales["de"] = txtAyudaDE.Text

End

' ============================================
' EVENTO: btnNuevo_Click
' DESCRIPCIÓN: Inicia el proceso de creación de una nueva ayuda
' ACCIONES:
'   - Limpia todo el formulario
'   - Habilita ComboBox de tablas
'   - Deshabilita controles de edición
'   - Configura modo nuevo
'   - Posiciona el foco en ComboBox de tablas
' ============================================
Public Sub btnNuevo_Click()

  ' LIMPIAR TODO EL FORMULARIO
  LimpiarFormulario()

  ' HABILITAR COMBOBOX DE TABLAS PARA INICIAR SELECCIÓN
  cmbTablas.Enabled = True
  cmbColumnas.Enabled = False

  ' DESHABILITAR CONTROLES DE EDICIÓN HASTA SELECCIONAR COLUMNA
  HabilitarControles(False)

  ' CONFIGURAR MODO NUEVO
  $modoEdicion = False
  $componenteOriginal = ""

  ' POSICIONAR FOCO EN COMBOBOX DE TABLAS
  cmbTablas.SetFocus()

End

' ============================================
' EVENTO: btnGuardar_Click
' DESCRIPCIÓN: Guarda la ayuda en la base de datos
' ACCIONES:
'   - Valida que todos los campos obligatorios tengan datos
'   - Valida que TODOS los 6 idiomas tengan contenido (no permite traducciones parciales)
'   - Inicia transacción
'   - Si es edición, elimina registros anteriores
'   - Inserta los 6 nuevos registros (uno por idioma)
'   - Confirma transacción
'   - Actualiza estado del formulario
' IMPORTANTE: Todos los idiomas son obligatorios, no se permiten traducciones parciales
' ============================================
Public Sub btnGuardar_Click()

  Dim sql As String
  Dim nombreComponente As String
  Dim clave As String
  Dim ayudas As New String[6]
  Dim idiomas As String[] = ["es", "pt", "en", "it", "fr", "de"]
  Dim i As Integer

  ' VALIDAR DATOS (INCLUYE VALIDACIÓN DE TODOS LOS IDIOMAS)
  If Not ValidarDatos() Then Return

  ' OBTENER DATOS DEL FORMULARIO
  nombreComponente = txtComponente.Text
  clave = txtClave.Text

  ' RECOPILAR AYUDAS DE LOS 6 IDIOMAS EN ARRAY
  ayudas[0] = txtAyudaES.Text
  ayudas[1] = txtAyudaPT.Text
  ayudas[2] = txtAyudaEN.Text
  ayudas[3] = txtAyudaIT.Text
  ayudas[4] = txtAyudaFR.Text
  ayudas[5] = txtAyudaDE.Text

  ' INICIAR TRANSACCIÓN PARA GARANTIZAR ATOMICIDAD
  Try m_ConexionBD.mConn.Begin()

  ' MANEJO DE ERROR EN INICIO DE TRANSACCIÓN
  If Error Then
    m_Sonido.sonar("Error")
    Message.Error("Error al iniciar transacción:\n" & Error.Text)
    Return
  Endif

  ' SI ES MODO EDICIÓN, ELIMINAR REGISTROS EXISTENTES PRIMERO
  If $modoEdicion Then
    sql = "DELETE FROM manual_ayudas WHERE componente = &1;"
    m_ConexionBD.mConn.Exec(sql, nombreComponente)

    ' VERIFICAR ERROR EN DELETE
    If Error Then
      m_ConexionBD.mConn.Rollback()
      m_Sonido.sonar("Error")
      Message.Error("Error al eliminar registros anteriores:\n" & Error.Text)
      Return
    Endif
  Endif

  ' INSERTAR LOS 6 IDIOMAS (UNO POR REGISTRO)
  For i = 0 To 5
    sql = "INSERT INTO manual_ayudas " &
      "(clave, componente, idioma, ayuda, usuario_creacion, usuario_modificacion) " &
      "VALUES (&1, &2, &3, &4, &5, &6);"
    Try m_ConexionBD.mConn.Exec(sql, clave, nombreComponente, idiomas[i], ayudas[i], $usuarioActual, $usuarioActual)

    ' VERIFICAR ERROR EN INSERT
    If Error Then
      m_ConexionBD.mConn.Rollback()
      m_Sonido.sonar("Error")
      Message.Error("Error al insertar ayuda para idioma " & idiomas[i] & ":\n" & Error.Text)
      Return
    Endif
  Next

  ' CONFIRMAR TRANSACCIÓN (COMMIT)
  m_ConexionBD.mConn.Commit()

  ' VERIFICAR ERROR EN COMMIT
  If Error Then
    m_Sonido.sonar("Error")
    Message.Error("Error al confirmar la transacción:\n" & Error.Text)
    Return
  Endif

  ' NOTIFICAR ÉXITO
  m_Sonido.sonar("Success")
  Message.Info("Ayuda guardada correctamente.")

  ' ACTUALIZAR ESTADO DEL FORMULARIO
  $modoEdicion = True
  $componenteOriginal = nombreComponente

  ' RECARGAR DATOS PARA ACTUALIZAR INFORMACIÓN DE AUDITORÍA
  CargarAyudaExistente(nombreComponente)

End

' ============================================
' FUNCIÓN: ValidarDatos
' DESCRIPCIÓN: Valida que todos los campos obligatorios tengan contenido válido
' PARÁMETROS: Ninguno
' RETORNA: Boolean (True si todo está válido, False si falta algo)
' VALIDACIONES:
'   1. Componente no vacío
'   2. Clave no vacía
'   3. TODOS los 6 idiomas deben tener contenido (traducción completa obligatoria)
' NOTA: Se usa Trim() para evitar que espacios en blanco cuenten como contenido
' ============================================
Private Function ValidarDatos() As Boolean

  ' VALIDACIÓN 1: COMPONENTE OBLIGATORIO
  If Not txtComponente.Text Or Trim(txtComponente.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe seleccionar un componente.")
    cmbColumnas.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 2: CLAVE OBLIGATORIA
  If Not txtClave.Text Or Trim(txtClave.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar una clave (texto del label).")
    txtClave.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 3: ESPAÑOL (es) OBLIGATORIO
  If Not txtAyudaES.Text Or Trim(txtAyudaES.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar la ayuda en ESPAÑOL.\n\nTodos los idiomas son obligatorios.")
    tabIdiomas.Index = 0  ' Tab Español
    txtAyudaES.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 4: PORTUGUÉS (pt) OBLIGATORIO
  If Not txtAyudaPT.Text Or Trim(txtAyudaPT.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar la ayuda en PORTUGUÉS.\n\nTodos los idiomas son obligatorios.")
    tabIdiomas.Index = 1  ' Tab Portugués
    txtAyudaPT.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 5: INGLÉS (en) OBLIGATORIO
  If Not txtAyudaEN.Text Or Trim(txtAyudaEN.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar la ayuda en INGLÉS.\n\nTodos los idiomas son obligatorios.")
    tabIdiomas.Index = 2  ' Tab Inglés
    txtAyudaEN.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 6: ITALIANO (it) OBLIGATORIO
  If Not txtAyudaIT.Text Or Trim(txtAyudaIT.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar la ayuda en ITALIANO.\n\nTodos los idiomas son obligatorios.")
    tabIdiomas.Index = 3  ' Tab Italiano
    txtAyudaIT.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 7: FRANCÉS (fr) OBLIGATORIO
  If Not txtAyudaFR.Text Or Trim(txtAyudaFR.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar la ayuda en FRANCÉS.\n\nTodos los idiomas son obligatorios.")
    tabIdiomas.Index = 4  ' Tab Francés
    txtAyudaFR.SetFocus()
    Return False
  Endif

  ' VALIDACIÓN 8: ALEMÁN (de) OBLIGATORIO
  If Not txtAyudaDE.Text Or Trim(txtAyudaDE.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("Debe ingresar la ayuda en ALEMÁN.\n\nTodos los idiomas son obligatorios.")
    tabIdiomas.Index = 5  ' Tab Alemán
    txtAyudaDE.SetFocus()
    Return False
  Endif

  ' TODAS LAS VALIDACIONES PASARON
  Return True

End

' ============================================
' EVENTO: btnEliminar_Click
' DESCRIPCIÓN: Elimina las ayudas de un componente en todos los idiomas
' ACCIONES:
'   - Valida que hay un componente seleccionado
'   - Valida que el componente tiene ayudas guardadas
'   - Solicita confirmación al usuario
'   - Elimina todos los registros del componente
'   - Limpia el formulario
' ============================================
Public Sub btnEliminar_Click()

  Dim sql As String
  Dim nombreComponente As String
  Dim respuesta As Integer

  ' VALIDACIÓN 1: COMPONENTE SELECCIONADO
  If Not txtComponente.Text Or Trim(txtComponente.Text) = "" Then
    m_Sonido.sonar("Info")
    Message.Info("No hay componente seleccionado para eliminar.")
    Return
  Endif

  ' VALIDACIÓN 2: COMPONENTE TIENE AYUDAS GUARDADAS
  If Not $modoEdicion Then
    m_Sonido.sonar("Info")
    Message.Info("Este componente no tiene ayudas guardadas.")
    Return
  Endif

  nombreComponente = txtComponente.Text

  ' CONFIRMAR ELIMINACIÓN CON EL USUARIO
  respuesta = Message.Question("¿Está seguro de eliminar las ayudas del componente '" & nombreComponente & "' en todos los idiomas?", "Sí", "No")

  ' SI USUARIO CANCELA, SALIR
  If respuesta <> 1 Then Return

  ' EJECUTAR DELETE
  sql = "DELETE FROM manual_ayudas WHERE componente = &1;"

  Try m_ConexionBD.mConn.Exec(sql, nombreComponente)

  ' MANEJO DE ERRORES
  If Error Then
    m_Sonido.sonar("Error")
    Message.Error("Error al eliminar:\n" & Error.Text)
    Return
  Endif

  ' NOTIFICAR ÉXITO
  m_Sonido.sonar("Success")
  Message.Info("Ayuda eliminada correctamente.")

  ' LIMPIAR FORMULARIO
  LimpiarFormulario()

End

' ============================================
' EVENTO: btnCancelar_Click
' DESCRIPCIÓN: Cancela los cambios realizados en el formulario
' ACCIONES:
'   - Si hay datos originales guardados, los restaura
'   - Si no hay datos originales, limpia el formulario
' ============================================
Public Sub btnCancelar_Click()

  ' SI HAY DATOS ORIGINALES, RESTAURARLOS
  If $datosOriginales Then
    txtClave.Text = $datosOriginales["clave"]
    txtAyudaES.Text = $datosOriginales["es"]
    txtAyudaPT.Text = $datosOriginales["pt"]
    txtAyudaEN.Text = $datosOriginales["en"]
    txtAyudaIT.Text = $datosOriginales["it"]
    txtAyudaFR.Text = $datosOriginales["fr"]
    txtAyudaDE.Text = $datosOriginales["de"]

    m_Sonido.sonar("Info")
    Message.Info("Cambios descartados.")
  Else
    ' SI NO HAY DATOS ORIGINALES, LIMPIAR TODO
    LimpiarFormulario()
  Endif

End

' ============================================
' EVENTO: btnCerrar_Click
' DESCRIPCIÓN: Cierra el formulario
' ============================================
Public Sub btnCerrar_Click()

  Me.Close()

End

' ============================================
' EVENTO: Form_KeyPress
' DESCRIPCIÓN: Maneja eventos de teclado en el formulario
' ACCIONES:
'   - Si se presiona ESC, cierra el formulario
' ============================================
Public Sub Form_KeyPress()

  ' CERRAR FORMULARIO CON TECLA ESC
  If Key.Code = Key.Esc Then
    Me.Close()
  Endif

End

' ============================================
' FUNCIÓN: LimpiarFormulario
' DESCRIPCIÓN: Limpia todo el formulario y lo reinicia al estado inicial
' PARÁMETROS: Ninguno
' RETORNA: Nada
' ACCIONES:
'   - Limpia ComboBoxes
'   - Recarga tablas
'   - Limpia datos
'   - Deshabilita controles
' ============================================
Private Sub LimpiarFormulario()

  ' LIMPIAR COMBOBOXES
  cmbTablas.Clear()
  cmbColumnas.Clear()

  ' RECARGAR TABLAS DISPONIBLES
  CargarTablas()

  ' LIMPIAR DATOS
  LimpiarDatos()

  ' DESHABILITAR CONTROLES DE EDICIÓN
  HabilitarControles(False)

End

' ============================================
' FUNCIÓN: LimpiarDatos
' DESCRIPCIÓN: Limpia solo los campos de datos, no los ComboBoxes
' PARÁMETROS: Ninguno
' RETORNA: Nada
' NOTA: NO limpia txtComponente porque se asigna automáticamente desde cmbColumnas
' ============================================
Private Sub LimpiarDatos()

  ' LIMPIAR CAMPOS EDITABLES
  ' NOTA: NO se limpia txtComponente porque se autocompleta desde cmbColumnas
  txtClave.Text = ""
  txtAyudaES.Text = ""
  txtAyudaPT.Text = ""
  txtAyudaEN.Text = ""
  txtAyudaIT.Text = ""
  txtAyudaFR.Text = ""
  txtAyudaDE.Text = ""

  ' LIMPIAR DATOS ORIGINALES
  $datosOriginales = Null

End

' ============================================
' FUNCIÓN: HabilitarControles
' DESCRIPCIÓN: Habilita o deshabilita los controles de edición
' PARÁMETROS:
'   habilitar (Boolean): True para habilitar, False para deshabilitar
' RETORNA: Nada
' NOTA: El botón Eliminar solo se habilita si está en modo edición
' ============================================
Private Sub HabilitarControles(habilitar As Boolean)

  ' HABILITAR/DESHABILITAR CONTROLES DE EDICIÓN
  txtClave.Enabled = habilitar
  tabIdiomas.Enabled = habilitar
  btnGuardar.Enabled = habilitar

  ' ELIMINAR SOLO SI ESTÁ EN MODO EDICIÓN
  btnEliminar.Enabled = habilitar And $modoEdicion

  ' CANCELAR HABILITADO SI HAY ALGO PARA EDITAR
  btnCancelar.Enabled = habilitar

End

' ============================================
' FUNCIÓN: ConfigurarTextAreas
' DESCRIPCIÓN: Configura las propiedades de todas las TextAreas del formulario
' PARÁMETROS: Ninguno
' RETORNA: Nada
' ACCIONES:
'   - Activa el Wrap (ajuste de línea) en todas las TextAreas
'   - Permite mejor visualización y edición de textos largos
' ============================================
Private Sub ConfigurarTextAreas()

  ' ACTIVAR WRAP (AJUSTE DE LÍNEA) EN TODAS LAS TEXTAREAS
  ' ESTO MEJORA LA EXPERIENCIA DE EDICIÓN AL NO REQUERIR SCROLL HORIZONTAL
  txtAyudaES.Wrap = True
  txtAyudaPT.Wrap = True
  txtAyudaEN.Wrap = True
  txtAyudaIT.Wrap = True
  txtAyudaFR.Wrap = True
  txtAyudaDE.Wrap = True

End
