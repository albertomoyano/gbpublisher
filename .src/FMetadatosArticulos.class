' Gambas class file

' DETECTA CTRL + F1
Public Sub Form_KeyRelease()

  If Key.Control And Key.Code = Key.F1 Then
    m_FuncionesGenericas.MostrarAyuda()
  Endif

End

Public Sub btnCerrar_Click()

  Me.Close()

End

Public Sub btnAgregarAutor_Click()

  m_Sonido.sonar("OpenApp")
  FAutores.ShowModal()

End

Public Sub btnNotasAutor_Click()

  f_TXTextendido.OriginalTextBox = notas_autor
  f_TXTextendido.ShowModal

End

Public Sub btnVerificarResumenGrafico_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(url_resumen_grafico)

End

Public Sub btnVerificarVideo_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(url_video_resumen)

End

Public Sub btnResumen_Click()

  f_TXTextendido.OriginalTextBox = resumen
  f_TXTextendido.ShowModal

End

Public Sub btnResumenIngles_Click()

  f_TXTextendido.OriginalTextBox = abstract_ingles
  f_TXTextendido.ShowModal

End

Public Sub btnResumenEstructurado_Click()

  f_TXTextendido.OriginalTextBox = abstract_estructurado
  f_TXTextendido.ShowModal

End

Public Sub btnResumenAdicional_Click()

  f_TXTextendido.OriginalTextBox = resumenes_adicionales
  f_TXTextendido.ShowModal

End

Public Sub btnVerificarRepositoriosURL_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(repositorio_codigo_url)

End

Public Sub btnVerificarRepositoriosURL2_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(url_repositorio_datos)

End

Public Sub btnVerificarRevision_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(url_revision)

End

Public Sub btnVerificarLicencia_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(url_licencia)

End

Public Sub btnVerificarPrePrint_Click()

  m_FuncionesGenericas.VerificarURLDesdeCampo(url_preprint)

End

Public Sub btnInternas_Click()

  f_TXTextendido.OriginalTextBox = notas_internas
  f_TXTextendido.ShowModal

End

Public Sub Form_Open()

  ' VERIFICAR QUE HAY UN PROYECTO ABIERTO
  If FMain.id_proyecto.Value <= 0 Then
    m_Sonido.sonar("Warning")
    Message.Warning("Debe abrir un proyecto antes de editar metadatos.")
    Me.Close
    Return
  Endif

  ' SINCRONIZAR EL id_proyecto
  id_proyecto.Value = FMain.id_proyecto.Value

End

Public Sub periodo_embargo_KeyPress()
  ' PERMITIR SOLO DÃGITOS Y TECLAS DE CONTROL

  If Not IsDigit(Key.Text) And Key.Code <> Key.BackSpace And Key.Code <> Key.Delete Then
    Stop Event
  Endif

End

Public Sub btnDataStatement_Click()

  f_TXTextendido.OriginalTextBox = data_availability_statement
  f_TXTextendido.ShowModal

End

Public Sub btnCodeStatement_Click()

  f_TXTextendido.OriginalTextBox = code_availability_statement
  f_TXTextendido.ShowModal

End

Public Sub btnTitulo_Click()

  f_TXTextendido.OriginalTextBox = titulo
  f_TXTextendido.ShowModal

End
