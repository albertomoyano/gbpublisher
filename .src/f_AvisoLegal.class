' Gambas class file

Public EsFormularioInicial As Boolean = True  ' Es pública para que se pueda modificar desde FMain
Private lastX As Integer
Private lastY As Integer

' RESTAURA LA POSICIÓN ORIGINAL
Public Sub Form_Move()

  Me.Move(lastX, lastY)

End

Public Sub Form_Open()

  Me.Center
  Me.Resizable = False
  lastX = Me.X
  lastY = Me.Y

  If EsFormularioInicial Then
    btnCerrarTerminos.Visible = True
    ButtonCerrarLegal.Visible = True
    SpringLegales.Visible = False
  Else
    btnCerrarTerminos.Visible = False
    ButtonCerrarLegal.Visible = True
    SpringLegales.Visible = True
  Endif

  Dim sHTML As String

  sHTML = "<html><head>" &
    "<meta charset='utf-8'>" &
    "<style>" &
    "html, body {line-height: 1.5; margin:0; padding:4px; overflow-x:hidden; box-sizing:border-box; max-width:99%;}" &
    "h3 {color: #004080;}" &
    "</style></head><body>"

  sHTML &= "<h3>DESCARGO DE RESPONSABILIDAD</h3>" &
    "<p> Este software se proporciona <strong>TAL CUAL, SIN GARANTÍA DE NINGÚN TIPO</strong>, expresa o implícita, incluyendo, entre otras, las garantías de comerciabilidad, idoneidad para un propósito particular y no infracción. En ningún caso los autores o titulares de los derechos de autor serán responsables por reclamos, daños u otras responsabilidades, ya sea en una acción contractual, extracontractual o de otro tipo, que surjan del uso del software o de cualquier actividad relacionada con él.</p>"

  sHTML &= "<h3>LICENCIA DEL SOFTWARE</h3>" &
    "<p>Este software es libre y gratuito y se distribuye bajo los términos de la Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International.<br>" &
    "Más información: <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es'>CC BY-NC-SA 4.0</a><br>" &
    "Copyright (c) 2025 Alberto Moyano.</p>"

  sHTML &= "<h3>DEPENDENCIAS EXTERNAS</h3>" &
    "<p>Este programa utiliza herramientas de terceros que deben estar instaladas en el sistema para su correcto funcionamiento. Estas dependencias no se redistribuyen junto con el software y conservan sus propias licencias, <strong>gbpublisher</strong> solo invoca estos programas mediante el sistema operativo, sin modificar ni redistribuir sus binarios o código fuente.</p>" &
    "<ul style='margin-left:10px; list-style-type:disc;'>" &
    "<li><b>LaTeX / TeX Live</b> — Licencia <a href='https://www.latex-project.org/lppl/lppl-1-3c/'>LPPL 1.3c</a></li>" &
    "<li><b>Pandoc</b> — Licencia <a href='https://www.gnu.org/licenses/old-licenses/gpl-2.0.html'>GPL v2 o posterior</a></li>" &
    "<li><b>GNU Parallel</b> — Licencia <a href='https://www.gnu.org/licenses/gpl-3.0.html'>GPL v3</a></li>" &
    "<li><b>MySQL (Community Edition)</b> — Licencia <a href='https://www.mysql.com/products/community/'>GPL (MySQL Community)</a></li>" &
    "<li><b>SQLite</b> — Dominio público (no requiere licencia). Más info: <a href='https://www.sqlite.org/copyright.html'>SQLite copyright</a></li>" &
    "<li><b>Saxon-HE</b> — Licencia <a href='https://www.mozilla.org/en-US/MPL/2.0/'>MPL 2.0</a></li>" &
    "<li><b>xmllint</b> — Parte del proyecto libxml2, Licencia <a href='http://xmlsoft.org/'>MIT</a></li>" &
    "</ul>"

  sHTML &= "<h3>RECURSOS UTILIZADOS</h3>" &
    "<p><b>Gambas:</b> esta aplicación está desarrollada con Gambas, un entorno de programación visual y lenguaje libre basado en BASIC, distribuido bajo la licencia GPL v3.<br>" &
    "Más información: <a href='https://gambas.sourceforge.net/'>https://gambas.sourceforge.net/</a></p>" &
    "<p><b>Bibliotecas GTK:</b> esta aplicación utiliza bibliotecas GTK 3, distribuidas bajo la licencia LGPL v2.1, desarrolladas por The GNOME Project y la comunidad GTK. Los usuarios pueden obtener, reemplazar o actualizar las bibliotecas GTK de forma independiente a este software, en cumplimiento de dicha licencia.<br>" &
    "Más información: <a href='https://www.gtk.org/'>https://www.gtk.org/</a></p>" &
    "<p><b>Íconos del proyecto Haiku:</b> esta aplicación utiliza íconos distribuidos bajo la licencia MIT. Agradecemos a sus desarrolladores y colaboradores.<br>" &
    "Más información: <a href='https://www.haiku-os.org/'>https://www.haiku-os.org/</a></p>"

  sHTML &= "<h3>NOTA SOBRE LA INTERFAZ</h3>" &
    "<p>La interfaz de esta aplicación no cuenta con soporte para modo oscuro. Si utiliza un entorno de escritorio con dicha opción activa, la apariencia del software podría no integrarse visualmente de manera óptima.</p>"

  sHTML &= "<h3>ALCANCE DEL SOPORTE</h3>" &
    "<p>Esta aplicación está diseñada y probada exclusivamente en entornos Linux Mint con el escritorio Cinnamon. El soporte oficial se limita a esta plataforma, garantizando su correcto funcionamiento. No se ofrece soporte para otros escritorios o distribuciones.<br>" &
    "Más información: <a href='https://linuxmint.com/'>https://linuxmint.com/</a></p>"

  sHTML &= "</body></html>"

  ' ASIGNAMOS EL HTML AL CONTROL
  HtmlViewLegales.Html = sHTML

End

Public Sub HtmlViewLegales_Link(Url As String)

  Shell "xdg-open " & Quote(Url) & " &"

End

' SOLO SE USA SI ES EL FORMULARIO INICIAL
Public Sub btnCerrarTerminos_Click()

  Me.Close()
  FMain.Show()
  Wait 0.1

End

' SOLO CIERRA EL FORMULARIO SI FUE ABIERTO DESDE FMAIN
Public Sub ButtonCerrarLegal_Click()

  Me.Close()

End
