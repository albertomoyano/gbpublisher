' Gambas class file

Public EsFormularioInicial As Boolean = True  ' Es pública para que se pueda modificar desde FMain
Private lastX As Integer
Private lastY As Integer

Public Sub Form_Open()

  Me.Center
  Me.Resizable = False
  lastX = Me.X
  lastY = Me.Y

  If EsFormularioInicial Then
    Menu1.Visible = True
  Else
    Menu1.Visible = False
  Endif

  Dim sHTML As String

  sHTML = "<html><head>" &
    "<meta charset='utf-8'>" &
    "<style>" &
    "html, body { line-height: 1.5; padding: 4px; margin: 0; overflow-x: hidden; word-wrap: break-word; box-sizing:border-box; }" &
    "h3 {color: #004080;}" &
    "</style></head><body>"

  sHTML &= "<h3>DESCARGO DE RESPONSABILIDAD</h3>" &
    "<p> Este software se proporciona <strong>TAL CUAL, SIN GARANTÍA DE NINGÚN TIPO</strong>, expresa o implícita, incluyendo, entre otras, las garantías de comerciabilidad, idoneidad para un propósito particular y no infracción. En ningún caso los autores o titulares de los derechos de autor serán responsables por reclamos, daños u otras responsabilidades, ya sea en una acción contractual, extracontractual o de otro tipo, que surjan del uso del software o de cualquier actividad relacionada con él.</p>"

  sHTML &= "<h3>LICENCIA DEL SOFTWARE</h3>" &
    "<p>Este software es libre y gratuito y se distribuye bajo los términos de la Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International.<br>" &
    "Más información: <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es'>CC BY-NC-SA 4.0</a><br>" &
    "Copyright (c) 2022–2025 Alberto Moyano.</p>"

  sHTML &= "<h3>USO DE API KEYS Y SERVICIOS EN LÍNEA</h3>" &
    "<p>Este software utiliza servicios en línea de terceros que requieren el uso de <strong>API Keys</strong> para habilitar determinadas funciones (por ejemplo: diccionarios, Inteligencia Articifial u otros servicios).<br>"
    "<strong>gbpublisher no incluye, no proporciona ni redistribuye ninguna API Key.</strong><br>"
    "Las claves de acceso deben ser obtenidas, gestionadas y configuradas exclusivamente por el usuario, utilizando los formularios provistos por la aplicación. Las API Keys utilizadas pueden estar disponibles bajo modalidades gratuitas ofrecidas por los respectivos proveedores, las cuales están sujetas a límites de uso, condiciones técnicas y términos de servicio definidos por dichos proveedores. El usuario es el <strong>único responsable</strong> del uso de sus API Keys, del cumplimiento de los términos de servicio, políticas de privacidad, límites de consumo, restricciones técnicas y cualquier consecuencia derivada de su utilización.<br><br>"
    "<strong>Nota sobre privacidad:</strong> las API Keys ingresadas por el usuario se almacenan en la base de datos (MySQL) utilizada por el programa con el único fin de permitir el funcionamiento de las funciones configuradas por el propio usuario. Estas claves no son compartidas, cedidas ni transmitidas a terceros distintos del proveedor del servicio correspondiente.<br>"
    "El software actúa únicamente como un cliente que realiza solicitudes en nombre del usuario utilizando las credenciales configuradas por éste. En ningún caso los autores del software serán responsables por suspensiones de servicio, revocación de claves, cambios en las condiciones de uso, interrupciones, costos asociados o cualquier otra consecuencia derivada del uso de servicios externos.</p>"

  sHTML &= "<h3>DEPENDENCIAS EXTERNAS</h3>" &
    "<p>Este programa utiliza herramientas de terceros que deben estar instaladas en el sistema para su correcto funcionamiento. Estas dependencias no se redistribuyen junto con el software y conservan sus propias licencias, <strong>gbpublisher</strong> solo invoca estos programas mediante el sistema operativo, sin modificar ni redistribuir sus binarios o código fuente.</p>" &
    "<ul style='margin-left:10px; list-style-type:disc;'>" &
    "<li><b>LaTeX / TeX Live</b> — Licencia <a href='https://www.latex-project.org/lppl/lppl-1-3c/'>LPPL 1.3c</a></li>" &
    "<li><b>Pandoc</b> — Licencia <a href='https://www.gnu.org/licenses/old-licenses/gpl-2.0.html'>GPL v2 o posterior</a></li>" &
    "<li><b>GNU Parallel</b> — Licencia <a href='https://www.gnu.org/licenses/gpl-3.0.html'>GPL v3</a></li>" &
    "<li><b>MySQL (Community Edition)</b> — Licencia <a href='https://www.mysql.com/products/community/'>GPL (MySQL Community)</a></li>" &
    "<li><b>SQLite</b> — Dominio público (no requiere licencia). Más info: <a href='https://www.sqlite.org/copyright.html'>SQLite copyright</a></li>" &
    "<li><b>Saxon-HE</b> — Licencia <a href='https://www.mozilla.org/en-US/MPL/2.0/'>MPL 2.0</a></li>" &
    "<li><b>xmllint</b> — Parte del proyecto libxml2, Licencia <a href='http://xmlsoft.org/'>MIT</a></li>" &
    "</ul>"

  sHTML &= "<h3>RECURSOS UTILIZADOS</h3>" &
    "<p><b>Gambas:</b> esta aplicación está desarrollada con Gambas, un entorno de programación visual y lenguaje libre basado en BASIC, distribuido bajo la licencia GPL v3.<br>" &
    "Más información: <a href='https://gambas.sourceforge.net/'>https://gambas.sourceforge.net/</a></p>" &
    "<p><b>Bibliotecas GTK:</b> esta aplicación utiliza bibliotecas GTK 3, distribuidas bajo la licencia LGPL v2.1, desarrolladas por The GNOME Project y la comunidad GTK. Los usuarios pueden obtener, reemplazar o actualizar las bibliotecas GTK de forma independiente a este software, en cumplimiento de dicha licencia.<br>" &
    "Más información: <a href='https://www.gtk.org/'>https://www.gtk.org/</a></p>" &
    "<p><b>Íconos:</b> esta aplicación utiliza íconos del proyecto Haiku distribuidos bajo la licencia MIT.<br>" &
    "Más información: <a href='https://www.haiku-os.org/'>https://www.haiku-os.org/</a></p>"

  sHTML &= "<h3>RESPONSABILIDAD SOBRE BASES DE DATOS Y GESTIÓN DE INFORMACIÓN</h3>" &
    "<p>Este software utiliza un motor de gestión de bases de datos <strong>MySQL</strong>, para almacenar información necesaria para su funcionamiento. La <strong>instalación, configuración, administración, mantenimiento, seguridad, control de accesos, copias de respaldo y recuperación de datos</strong> son responsabilidad exclusiva del usuario o de la entidad que implemente el software.<br>"
    "En entornos institucionales (editoriales, universidades, centros de investigación u organizaciones similares), estas tareas corresponden al <strong>área de sistemas, informática o infraestructura tecnológica</strong> de la institución usuaria.<br>"
    "Los autores de <strong>gbpublisher</strong> no asumen NINGUNA responsabilidad por configuraciones incorrectas, fallos de seguridad, fallas de hardware, pérdida, corrupción o exposición de datos, accesos no autorizados, interrupciones del servicio o incumplimientos normativos derivados de la gestión de la base de datos.<br>"
    "Cuando el motor de gestión de bases de datos se utiliza en <strong>modo local (IP 127.0.0.1)</strong>, el usuario es el <strong>único responsable</strong> de los datos almacenados, de su integridad, confidencialidad, disponibilidad y respaldo, así como del uso que haga de dicha información.<br>"
    "El software actúa únicamente como una herramienta cliente que interactúa con la base de datos configurada por el usuario, sin imponer políticas de seguridad, retención, auditoría, cifrado ni control de acceso sobre la información almacenada.</p>"

  sHTML &= "<h3>NOTA SOBRE LA INTERFAZ</h3>" &
    "<p>La interfaz de esta aplicación no cuenta con soporte para modo oscuro. Si utiliza un entorno de escritorio con dicha opción activa, la apariencia del software podría no integrarse visualmente de manera óptima.</p>"

  sHTML &= "<h3>ALCANCE DEL SOPORTE GRATUITO</h3>" &
    "<p>Esta aplicación está diseñada y probada exclusivamente en entornos Linux Mint con el escritorio Cinnamon. El soporte se limita a esta plataforma, garantizando su correcto funcionamiento.<br>" &
    "Más información: <a href='https://linuxmint.com/'>https://linuxmint.com/</a></p><br>"

  sHTML &= "</body></html>"

  ' ASIGNAMOS EL HTML AL CONTROL
  HtmlViewLegales.Html = sHTML

End

Public Sub HtmlViewLegales_Link(Url As String)

  Shell "xdg-open " & Quote(Url) & " &"

End

' SOLO CIERRA EL FORMULARIO SI FUE ABIERTO DESDE FMAIN
Public Sub ButtonCerrarLegal_Click()

  Me.Close()

End

Public Sub menuRevista_Click()

  Me.Close()
  FMain.Show()
  FMain.menuAbrirRevista.Visible = True
  FMain.menuAbrirLibroMD.Visible = False
  FMain.menuAbrirLibroLTX.Visible = False
  Wait 0.1

End

Public Sub menuSalir_Click()

  Me.Close()

End
