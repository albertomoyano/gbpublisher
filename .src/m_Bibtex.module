' Gambas module file

Private ContenidoBib As Result
' Private arrControlNames As String[] = [
'   "idBibtex",
'   "id_articulo",
'   "idRevistaBibtex",
'   "cmbTipoDeEntrada",
'   "txtAuthor",
'   "txtTitle",
'   "cmbTipoDeTesis",
'   "txtClaveBibtex",
'   "txtNameAddOn",
'   "txtBookAuthor",
'   "txtEditor",
'   "txtEditorA",
'   "txtEditorB",
'   "txtEditorC",
'   "txtAfterword",
'   "txtForeword",
'   "txtCommentator",
'   "txtIntroduction",
'   "txtTranslator",
'   "txtAnnotator",
'   "txtHolder",
'   "txtGender",
'   "txtShortAuthor",
'   "cmbEditorType",
'   "cmbEditorTypeA",
'   "cmbEditorTypeB",
'   "cmbEditorTypeC",
'   "txtTitleAddOn",
'   "txtSubTitle",
'   "txtSeries",
'   "txtBookTitle",
'   "txtBookTitleAddOn",
'   "txtMainTitle",
'   "txtMainTitleAddOn",
'   "txtJournalTitle",
'   "txtJournalTitleAddOn",
'   "txtIssueTitle",
'   "txtIssueTitleAddOn",
'   "txtEventTitle",
'   "txtEventTitleAddOn",
'   "txtIndexTitle",
'   "txtShortTitle",
'   "txtReprintTitle",
'   "txtVolume",
'   "txtVolumes",
'   "txtNumber",
'   "txtChapter",
'   "txtEid",
'   "txtPart",
'   "txtEdition",
'   "txtIssue",
'   "txtYear",
'   "txtEventDate",
'   "txtDate",
'   "txtOrigDate",
'   "txtUrlDate",
'   "txtVersion",
'   "cmbHyphenation",
'   "cmbLanguage",
'   "cmbOrigLanguage",
'   "cmbLangId",
'   "txtLandIdOpts",
'   "cmbPubState",
'   "txtPages",
'   "txtPageTotal",
'   "cmbPagination",
'   "cmbBookPagination",
'   "txtLocation",
'   "txtOrigLocation",
'   "txtInstitution",
'   "txtOrganization",
'   "txtPublisher",
'   "txtOrigPublisher",
'   "txtVenue",
'   "txtEprint",
'   "cmbEprintType",
'   "txtUrl",
'   "txtIsbn",
'   "txtIssn",
'   "txtIsmn",
'   "txtIsrn",
'   "txtIsan",
'   "txtIswc",
'   "txtDoi",
'   "cmbRelatedType",
'   "txtRelated",
'   "txtRelatedString",
'   "txtAddendum",
'   "txtEntrySubType",
'   "txtOptions",
'   "txtLabel",
'   "txtHowPublished",
'   "txtShortHand",
'   "txtShortHandIntro",
'   "txtIds",
'   "txtEntrySet",
'   "txtCrossRef",
'   "txtXref",
'   "txtXdata",
'   "txtPreSort",
'   "txtSortKey",
'   "txtSortName",
'   "txtSortHand",
'   "txtSortYear",
'   "txtSortTitle",
'   "txtIndexSortTitle",
'   "txtAbstract",
'   "txtNote",
'   "txtLibrary",
'   "txtAnnotation",
'   "txtFile"
'
' ]

Public Sub ConfigurarTableViewBibtexEnCurso(grid As GridView)

  With grid
    .Header = True
    .Grid = True
    .Columns.Count = 112

    ' Configuración de columnas
    For i As Integer = 0 To 111
      Select Case i
        Case 6
          .Columns[i].Title = "Autor"
          .Columns[i].Width = 200
        Case 7
          .Columns[i].Title = "Editor"
          .Columns[i].Width = 200
        Case 8
          .Columns[i].Title = "Título"
          .Columns[i].Width = 340
        Case 51
          .Columns[i].Title = "Año"
          .Columns[i].Width = 60
        Case 53
          .Columns[i].Title = "Fecha"
          .Columns[i].Width = 100
        Case Else
          .Columns[i].Title = ""
          .Columns[i].Width = 0
      End Select
    Next
  End With

End

Public Function VerificarCaracteresInvalidos() As Boolean

  Dim aCampos As TextBox[] = [FMain.txtAuthor, FMain.txtBookAuthor, FMain.txtEditor, FMain.txtEditorA, FMain.txtEditorB, FMain.txtEditorC]
  Dim aNombres As String[] = ["author", "bookauthor", "editor", "editor-a", "editor-b", "editor-c"]
  Dim i As Integer

  For i = 0 To aCampos.Max
    If InStr(aCampos[i].Text, ";") > 0 Then
      Message.Error("El campo de " & aNombres[i] & " no debe contener el carácter ; (punto y coma). Por favor, revisa tu entrada.")
      aCampos[i].SetFocus
      Return True ' ← Indica que hay un error
    End If
  Next

  Return False ' ← Indica que todo está bien

End

Public Function VerificacionBase() As Boolean

  If FMain.cmbTipoDeEntrada.Text = "" Then
    Message.Error("Debe seleccionar un tipo de entrada.")
    FMain.cmbTipoDeEntrada.SetFocus
    Return True
  Endif

  If FMain.cmbHyphenation.Text = "" Then
    Message.Error("Debe seleccionar un idioma.")
    FMain.cmbHyphenation.SetFocus
    Return True
  Endif

  If FMain.cmbTipoDeEntrada.Text = "thesis" And FMain.cmbTipoDeTesis.Text = "" Then
    Message.Error("Debe seleccionar el tipo de tesis.")
    FMain.cmbTipoDeTesis.SetFocus
    Return True
  Endif

  Return False

End

Public Sub RellenarComboBoxBibTeX()

  FMain.cmbTipoDeEntrada.Add("")
  FMain.cmbTipoDeEntrada.Add("article")
  FMain.cmbTipoDeEntrada.Add("incollection")
  FMain.cmbTipoDeEntrada.Add("book")
  FMain.cmbTipoDeEntrada.Add("thesis")
  FMain.cmbTipoDeEntrada.Add("online")
  FMain.cmbTipoDeEntrada.Add("inproceedings")
  FMain.cmbTipoDeEntrada.Add("mvbook")
  FMain.cmbTipoDeEntrada.Add("inbook")
  FMain.cmbTipoDeEntrada.Add("bookinbook")
  FMain.cmbTipoDeEntrada.Add("suppbook")
  FMain.cmbTipoDeEntrada.Add("booklet")
  FMain.cmbTipoDeEntrada.Add("collection")
  FMain.cmbTipoDeEntrada.Add("mvcollection")
  FMain.cmbTipoDeEntrada.Add("suppcollection")
  FMain.cmbTipoDeEntrada.Add("manual")
  FMain.cmbTipoDeEntrada.Add("misc")
  FMain.cmbTipoDeEntrada.Add("patent")
  FMain.cmbTipoDeEntrada.Add("periodical")
  FMain.cmbTipoDeEntrada.Add("suppperiodical")
  FMain.cmbTipoDeEntrada.Add("proceedings")
  FMain.cmbTipoDeEntrada.Add("mvproceedings")
  FMain.cmbTipoDeEntrada.Add("reference")
  FMain.cmbTipoDeEntrada.Add("mvreference")
  FMain.cmbTipoDeEntrada.Add("inreference")
  FMain.cmbTipoDeEntrada.Add("report")
  FMain.cmbTipoDeEntrada.Add("set")
  FMain.cmbTipoDeEntrada.Add("unpublished")
  FMain.cmbTipoDeEntrada.Add("xdata")
  FMain.cmbTipoDeEntrada.Add("movie")
  FMain.cmbTipoDeEntrada.Add("conference")
  FMain.cmbTipoDeEntrada.Add("software")

  FMain.cmbHyphenation.Add("")' babel
  FMain.cmbHyphenation.Add("spanish")
  FMain.cmbHyphenation.Add("portuguese")
  FMain.cmbHyphenation.Add("english")
  FMain.cmbHyphenation.Add("french")
  FMain.cmbHyphenation.Add("american")
  FMain.cmbHyphenation.Add("british")
  FMain.cmbHyphenation.Add("afrikaans")
  FMain.cmbHyphenation.Add("albanian")
  FMain.cmbHyphenation.Add("arabic")
  FMain.cmbHyphenation.Add("armenian")
  FMain.cmbHyphenation.Add("austrian")
  FMain.cmbHyphenation.Add("bahasa")
  FMain.cmbHyphenation.Add("basque")
  FMain.cmbHyphenation.Add("breton")
  FMain.cmbHyphenation.Add("bulgarian")
  FMain.cmbHyphenation.Add("catalan")
  FMain.cmbHyphenation.Add("croatian")
  FMain.cmbHyphenation.Add("czech")
  FMain.cmbHyphenation.Add("danish")
  FMain.cmbHyphenation.Add("dutch")
  FMain.cmbHyphenation.Add("esperanto")
  FMain.cmbHyphenation.Add("estonian")
  FMain.cmbHyphenation.Add("finnish")
  FMain.cmbHyphenation.Add("galician")
  FMain.cmbHyphenation.Add("german")
  FMain.cmbHyphenation.Add("greek")
  FMain.cmbHyphenation.Add("hebrew")
  FMain.cmbHyphenation.Add("hungarian")
  FMain.cmbHyphenation.Add("icelandic")
  FMain.cmbHyphenation.Add("interlingua")
  FMain.cmbHyphenation.Add("irish")
  FMain.cmbHyphenation.Add("italian")
  FMain.cmbHyphenation.Add("latin")
  FMain.cmbHyphenation.Add("latvian")
  FMain.cmbHyphenation.Add("lithuanian")
  FMain.cmbHyphenation.Add("lowersorbian")
  FMain.cmbHyphenation.Add("magyar")
  FMain.cmbHyphenation.Add("naustrian")
  FMain.cmbHyphenation.Add("ngerman")
  FMain.cmbHyphenation.Add("norsk")
  FMain.cmbHyphenation.Add("nynorsk")
  FMain.cmbHyphenation.Add("polish")
  FMain.cmbHyphenation.Add("romanian")
  FMain.cmbHyphenation.Add("russian")
  FMain.cmbHyphenation.Add("scottish")
  FMain.cmbHyphenation.Add("serbian")
  FMain.cmbHyphenation.Add("slovak")
  FMain.cmbHyphenation.Add("slovene")
  FMain.cmbHyphenation.Add("swedish")
  FMain.cmbHyphenation.Add("turkish")
  FMain.cmbHyphenation.Add("ukrainian")
  FMain.cmbHyphenation.Add("uppersorbian")
  FMain.cmbHyphenation.Add("welsh")

  FMain.cmbLanguage.Add("")
  FMain.cmbLanguage.Add("spanish")
  FMain.cmbLanguage.Add("portuguese")
  FMain.cmbLanguage.Add("english")
  FMain.cmbLanguage.Add("french")
  FMain.cmbLanguage.Add("afrikaans")
  FMain.cmbLanguage.Add("albanian")
  FMain.cmbLanguage.Add("amharic")
  FMain.cmbLanguage.Add("arabic")
  FMain.cmbLanguage.Add("armenian")
  FMain.cmbLanguage.Add("asturian")
  FMain.cmbLanguage.Add("bahasai")
  FMain.cmbLanguage.Add("bahasam")
  FMain.cmbLanguage.Add("basque")
  FMain.cmbLanguage.Add("bengali")
  FMain.cmbLanguage.Add("bidi")
  FMain.cmbLanguage.Add("bosnian")
  FMain.cmbLanguage.Add("breton")
  FMain.cmbLanguage.Add("bulgarian")
  FMain.cmbLanguage.Add("catalan")
  FMain.cmbLanguage.Add("chinese")
  FMain.cmbLanguage.Add("churchslavonic")
  FMain.cmbLanguage.Add("coptic")
  FMain.cmbLanguage.Add("croatian")
  FMain.cmbLanguage.Add("czech")
  FMain.cmbLanguage.Add("danish")
  FMain.cmbLanguage.Add("divehi")
  FMain.cmbLanguage.Add("dutch")
  FMain.cmbLanguage.Add("esperanto")
  FMain.cmbLanguage.Add("estonian")
  FMain.cmbLanguage.Add("farsi")
  FMain.cmbLanguage.Add("finnish")
  FMain.cmbLanguage.Add("friulan")
  FMain.cmbLanguage.Add("galician")
  FMain.cmbLanguage.Add("georgian")
  FMain.cmbLanguage.Add("german")
  FMain.cmbLanguage.Add("greek")
  FMain.cmbLanguage.Add("hebrew")
  FMain.cmbLanguage.Add("hindi")
  FMain.cmbLanguage.Add("hungarian")
  FMain.cmbLanguage.Add("icelandic")
  FMain.cmbLanguage.Add("interlingua")
  FMain.cmbLanguage.Add("irish")
  FMain.cmbLanguage.Add("italian")
  FMain.cmbLanguage.Add("japanese")
  FMain.cmbLanguage.Add("kannada")
  FMain.cmbLanguage.Add("khmer")
  FMain.cmbLanguage.Add("korean")
  FMain.cmbLanguage.Add("kurdish")
  FMain.cmbLanguage.Add("lao")
  FMain.cmbLanguage.Add("latin")
  FMain.cmbLanguage.Add("latvian")
  FMain.cmbLanguage.Add("lithuanian")
  FMain.cmbLanguage.Add("lsorbian")
  FMain.cmbLanguage.Add("macedonian")
  FMain.cmbLanguage.Add("malayalam")
  FMain.cmbLanguage.Add("marathi")
  FMain.cmbLanguage.Add("nko")
  FMain.cmbLanguage.Add("norwegian")
  FMain.cmbLanguage.Add("nynorsk")
  FMain.cmbLanguage.Add("occitan")
  FMain.cmbLanguage.Add("piedmontese")
  FMain.cmbLanguage.Add("polish")
  FMain.cmbLanguage.Add("punjabi")
  FMain.cmbLanguage.Add("romanian")
  FMain.cmbLanguage.Add("romansh")
  FMain.cmbLanguage.Add("russian")
  FMain.cmbLanguage.Add("sami")
  FMain.cmbLanguage.Add("sanskrit")
  FMain.cmbLanguage.Add("scottish")
  FMain.cmbLanguage.Add("serbian")
  FMain.cmbLanguage.Add("slovak")
  FMain.cmbLanguage.Add("slovenian")
  FMain.cmbLanguage.Add("swedish")
  FMain.cmbLanguage.Add("syriac")
  FMain.cmbLanguage.Add("tamil")
  FMain.cmbLanguage.Add("telugu")
  FMain.cmbLanguage.Add("thai")
  FMain.cmbLanguage.Add("tibetan")
  FMain.cmbLanguage.Add("turkish")
  FMain.cmbLanguage.Add("turkmen")
  FMain.cmbLanguage.Add("ukrainian")
  FMain.cmbLanguage.Add("urdu")
  FMain.cmbLanguage.Add("usorbian")
  FMain.cmbLanguage.Add("vietnamese")
  FMain.cmbLanguage.Add("welsh")

  FMain.cmbOrigLanguage.Add("")
  FMain.cmbOrigLanguage.Add("spanish")
  FMain.cmbOrigLanguage.Add("portuguese")
  FMain.cmbOrigLanguage.Add("english")
  FMain.cmbOrigLanguage.Add("french")
  FMain.cmbOrigLanguage.Add("afrikaans")
  FMain.cmbOrigLanguage.Add("albanian")
  FMain.cmbOrigLanguage.Add("amharic")
  FMain.cmbOrigLanguage.Add("arabic")
  FMain.cmbOrigLanguage.Add("armenian")
  FMain.cmbOrigLanguage.Add("asturian")
  FMain.cmbOrigLanguage.Add("bahasai")
  FMain.cmbOrigLanguage.Add("bahasam")
  FMain.cmbOrigLanguage.Add("basque")
  FMain.cmbOrigLanguage.Add("bengali")
  FMain.cmbOrigLanguage.Add("bidi")
  FMain.cmbOrigLanguage.Add("bosnian")
  FMain.cmbOrigLanguage.Add("breton")
  FMain.cmbOrigLanguage.Add("bulgarian")
  FMain.cmbOrigLanguage.Add("catalan")
  FMain.cmbOrigLanguage.Add("chinese")
  FMain.cmbOrigLanguage.Add("churchslavonic")
  FMain.cmbOrigLanguage.Add("coptic")
  FMain.cmbOrigLanguage.Add("croatian")
  FMain.cmbOrigLanguage.Add("czech")
  FMain.cmbOrigLanguage.Add("danish")
  FMain.cmbOrigLanguage.Add("divehi")
  FMain.cmbOrigLanguage.Add("dutch")
  FMain.cmbOrigLanguage.Add("esperanto")
  FMain.cmbOrigLanguage.Add("estonian")
  FMain.cmbOrigLanguage.Add("farsi")
  FMain.cmbOrigLanguage.Add("finnish")
  FMain.cmbOrigLanguage.Add("friulan")
  FMain.cmbOrigLanguage.Add("galician")
  FMain.cmbOrigLanguage.Add("georgian")
  FMain.cmbOrigLanguage.Add("german")
  FMain.cmbOrigLanguage.Add("greek")
  FMain.cmbOrigLanguage.Add("hebrew")
  FMain.cmbOrigLanguage.Add("hindi")
  FMain.cmbOrigLanguage.Add("hungarian")
  FMain.cmbOrigLanguage.Add("icelandic")
  FMain.cmbOrigLanguage.Add("interlingua")
  FMain.cmbOrigLanguage.Add("irish")
  FMain.cmbOrigLanguage.Add("italian")
  FMain.cmbOrigLanguage.Add("japanese")
  FMain.cmbOrigLanguage.Add("kannada")
  FMain.cmbOrigLanguage.Add("khmer")
  FMain.cmbOrigLanguage.Add("korean")
  FMain.cmbOrigLanguage.Add("kurdish")
  FMain.cmbOrigLanguage.Add("lao")
  FMain.cmbOrigLanguage.Add("latin")
  FMain.cmbOrigLanguage.Add("latvian")
  FMain.cmbOrigLanguage.Add("lithuanian")
  FMain.cmbOrigLanguage.Add("lsorbian")
  FMain.cmbOrigLanguage.Add("macedonian")
  FMain.cmbOrigLanguage.Add("malayalam")
  FMain.cmbOrigLanguage.Add("marathi")
  FMain.cmbOrigLanguage.Add("nko")
  FMain.cmbOrigLanguage.Add("norwegian")
  FMain.cmbOrigLanguage.Add("nynorsk")
  FMain.cmbOrigLanguage.Add("occitan")
  FMain.cmbOrigLanguage.Add("piedmontese")
  FMain.cmbOrigLanguage.Add("polish")
  FMain.cmbOrigLanguage.Add("punjabi")
  FMain.cmbOrigLanguage.Add("romanian")
  FMain.cmbOrigLanguage.Add("romansh")
  FMain.cmbOrigLanguage.Add("russian")
  FMain.cmbOrigLanguage.Add("sami")
  FMain.cmbOrigLanguage.Add("sanskrit")
  FMain.cmbOrigLanguage.Add("scottish")
  FMain.cmbOrigLanguage.Add("serbian")
  FMain.cmbOrigLanguage.Add("slovak")
  FMain.cmbOrigLanguage.Add("slovenian")
  FMain.cmbOrigLanguage.Add("swedish")
  FMain.cmbOrigLanguage.Add("syriac")
  FMain.cmbOrigLanguage.Add("tamil")
  FMain.cmbOrigLanguage.Add("telugu")
  FMain.cmbOrigLanguage.Add("thai")
  FMain.cmbOrigLanguage.Add("tibetan")
  FMain.cmbOrigLanguage.Add("turkish")
  FMain.cmbOrigLanguage.Add("turkmen")
  FMain.cmbOrigLanguage.Add("ukrainian")
  FMain.cmbOrigLanguage.Add("urdu")
  FMain.cmbOrigLanguage.Add("usorbian")
  FMain.cmbOrigLanguage.Add("vietnamese")
  FMain.cmbOrigLanguage.Add("welsh")

  FMain.cmbLangId.Add("")
  FMain.cmbLangId.Add("spanish")
  FMain.cmbLangId.Add("portuguese")
  FMain.cmbLangId.Add("english")
  FMain.cmbLangId.Add("french")
  FMain.cmbLangId.Add("afrikaans")
  FMain.cmbLangId.Add("albanian")
  FMain.cmbLangId.Add("amharic")
  FMain.cmbLangId.Add("arabic")
  FMain.cmbLangId.Add("armenian")
  FMain.cmbLangId.Add("asturian")
  FMain.cmbLangId.Add("bahasai")
  FMain.cmbLangId.Add("bahasam")
  FMain.cmbLangId.Add("basque")
  FMain.cmbLangId.Add("bengali")
  FMain.cmbLangId.Add("bidi")
  FMain.cmbLangId.Add("bosnian")
  FMain.cmbLangId.Add("breton")
  FMain.cmbLangId.Add("bulgarian")
  FMain.cmbLangId.Add("catalan")
  FMain.cmbLangId.Add("chinese")
  FMain.cmbLangId.Add("churchslavonic")
  FMain.cmbLangId.Add("coptic")
  FMain.cmbLangId.Add("croatian")
  FMain.cmbLangId.Add("czech")
  FMain.cmbLangId.Add("danish")
  FMain.cmbLangId.Add("divehi")
  FMain.cmbLangId.Add("dutch")
  FMain.cmbLangId.Add("esperanto")
  FMain.cmbLangId.Add("estonian")
  FMain.cmbLangId.Add("farsi")
  FMain.cmbLangId.Add("finnish")
  FMain.cmbLangId.Add("friulan")
  FMain.cmbLangId.Add("galician")
  FMain.cmbLangId.Add("georgian")
  FMain.cmbLangId.Add("german")
  FMain.cmbLangId.Add("greek")
  FMain.cmbLangId.Add("hebrew")
  FMain.cmbLangId.Add("hindi")
  FMain.cmbLangId.Add("hungarian")
  FMain.cmbLangId.Add("icelandic")
  FMain.cmbLangId.Add("interlingua")
  FMain.cmbLangId.Add("irish")
  FMain.cmbLangId.Add("italian")
  FMain.cmbLangId.Add("japanese")
  FMain.cmbLangId.Add("kannada")
  FMain.cmbLangId.Add("khmer")
  FMain.cmbLangId.Add("korean")
  FMain.cmbLangId.Add("kurdish")
  FMain.cmbLangId.Add("lao")
  FMain.cmbLangId.Add("latin")
  FMain.cmbLangId.Add("latvian")
  FMain.cmbLangId.Add("lithuanian")
  FMain.cmbLangId.Add("lsorbian")
  FMain.cmbLangId.Add("macedonian")
  FMain.cmbLangId.Add("malayalam")
  FMain.cmbLangId.Add("marathi")
  FMain.cmbLangId.Add("nko")
  FMain.cmbLangId.Add("norwegian")
  FMain.cmbLangId.Add("nynorsk")
  FMain.cmbLangId.Add("occitan")
  FMain.cmbLangId.Add("piedmontese")
  FMain.cmbLangId.Add("polish")
  FMain.cmbLangId.Add("punjabi")
  FMain.cmbLangId.Add("romanian")
  FMain.cmbLangId.Add("romansh")
  FMain.cmbLangId.Add("russian")
  FMain.cmbLangId.Add("sami")
  FMain.cmbLangId.Add("sanskrit")
  FMain.cmbLangId.Add("scottish")
  FMain.cmbLangId.Add("serbian")
  FMain.cmbLangId.Add("slovak")
  FMain.cmbLangId.Add("slovenian")
  FMain.cmbLangId.Add("swedish")
  FMain.cmbLangId.Add("syriac")
  FMain.cmbLangId.Add("tamil")
  FMain.cmbLangId.Add("telugu")
  FMain.cmbLangId.Add("thai")
  FMain.cmbLangId.Add("tibetan")
  FMain.cmbLangId.Add("turkish")
  FMain.cmbLangId.Add("turkmen")
  FMain.cmbLangId.Add("ukrainian")
  FMain.cmbLangId.Add("urdu")
  FMain.cmbLangId.Add("usorbian")
  FMain.cmbLangId.Add("vietnamese")
  FMain.cmbLangId.Add("welsh")

  FMain.cmbTipoDeTesis.Add("")
  FMain.cmbTipoDeTesis.Add("tifthesis")
  FMain.cmbTipoDeTesis.Add("mathesis")
  FMain.cmbTipoDeTesis.Add("phdthesis")
  FMain.cmbTipoDeTesis.Add("candthesis")
  FMain.cmbTipoDeTesis.Add("ingenieriathesis")
  FMain.cmbTipoDeTesis.Add("magisterthesis")
  FMain.cmbTipoDeTesis.Add("gradothesis")
  FMain.cmbTipoDeTesis.Add("licenciaturathesis")
  FMain.cmbTipoDeTesis.Add("especialthesis")
  FMain.cmbTipoDeTesis.Add("posgradothesis")
  FMain.cmbTipoDeTesis.Add("profesoradothesis")

  FMain.cmbPagination.Add("")' lo dejo para compatibilidad con referencias viejas
  FMain.cmbPagination.Add("page")
  FMain.cmbPagination.Add("column")
  FMain.cmbPagination.Add("line")
  FMain.cmbPagination.Add("verse")
  FMain.cmbPagination.Add("section")
  FMain.cmbPagination.Add("paragraph")

  FMain.cmbBookPagination.Add("")' lo dejo para compatibilidad con referencias viejas
  FMain.cmbBookPagination.Add("page")
  FMain.cmbBookPagination.Add("column")
  FMain.cmbBookPagination.Add("line")
  FMain.cmbBookPagination.Add("verse")
  FMain.cmbBookPagination.Add("section")
  FMain.cmbBookPagination.Add("paragraph")

  FMain.CmbRelatedType.Add("")
  FMain.CmbRelatedType.Add("reprintof")
  FMain.CmbRelatedType.Add("translationof")
  FMain.CmbRelatedType.Add("translatedas")
  FMain.CmbRelatedType.Add("multivolume")

  FMain.cmbPubState.Add("")
  FMain.cmbPubState.Add("mimeograph")
  FMain.cmbPubState.Add("photocopy")
  FMain.cmbPubState.Add("digitalprinting")
  FMain.cmbPubState.Add("inpreparation")
  FMain.cmbPubState.Add("submitted")
  FMain.cmbPubState.Add("forthcoming")
  FMain.cmbPubState.Add("inpress")
  FMain.cmbPubState.Add("prepublished")
  FMain.cmbPubState.Add("edauthor")

  FMain.cmbEditorType.Add("")
  FMain.cmbEditorType.Add("editor")
  FMain.cmbEditorType.Add("compiler")
  FMain.cmbEditorType.Add("direction")
  FMain.cmbEditorType.Add("founder")
  FMain.cmbEditorType.Add("continuator")
  FMain.cmbEditorType.Add("redactor")
  FMain.cmbEditorType.Add("reviser")
  FMain.cmbEditorType.Add("collaborator")
  FMain.cmbEditorType.Add("cordinator")
  FMain.cmbEditorType.Add("organizator")

  FMain.cmbEditorTypeA.Add("")
  FMain.cmbEditorTypeA.Add("editor")
  FMain.cmbEditorTypeA.Add("compiler")
  FMain.cmbEditorTypeA.Add("direction")
  FMain.cmbEditorTypeA.Add("founder")
  FMain.cmbEditorTypeA.Add("continuator")
  FMain.cmbEditorTypeA.Add("redactor")
  FMain.cmbEditorTypeA.Add("reviser")
  FMain.cmbEditorTypeA.Add("collaborator")
  FMain.cmbEditorTypeA.Add("cordinator")
  FMain.cmbEditorTypeA.Add("organizator")

  FMain.cmbEditorTypeB.Add("")
  FMain.cmbEditorTypeB.Add("editor")
  FMain.cmbEditorTypeB.Add("compiler")
  FMain.cmbEditorTypeB.Add("direction")
  FMain.cmbEditorTypeB.Add("founder")
  FMain.cmbEditorTypeB.Add("continuator")
  FMain.cmbEditorTypeB.Add("redactor")
  FMain.cmbEditorTypeB.Add("reviser")
  FMain.cmbEditorTypeB.Add("collaborator")
  FMain.cmbEditorTypeB.Add("cordinator")
  FMain.cmbEditorTypeB.Add("organizator")

  FMain.cmbEditorTypeC.Add("")
  FMain.cmbEditorTypeC.Add("editor")
  FMain.cmbEditorTypeC.Add("compiler")
  FMain.cmbEditorTypeC.Add("direction")
  FMain.cmbEditorTypeC.Add("founder")
  FMain.cmbEditorTypeC.Add("continuator")
  FMain.cmbEditorTypeC.Add("redactor")
  FMain.cmbEditorTypeC.Add("reviser")
  FMain.cmbEditorTypeC.Add("collaborator")
  FMain.cmbEditorTypeC.Add("cordinator")
  FMain.cmbEditorTypeC.Add("organizator")

  FMain.cmbEprintType.Add("")
  FMain.cmbEprintType.Add("arXiv")
  FMain.cmbEprintType.Add("PubMed")
  FMain.cmbEprintType.Add("JSTOR")
  FMain.cmbEprintType.Add("Handle System (HDL)")
  FMain.cmbEprintType.Add("URL")
  FMain.cmbEprintType.Add("DOI")

End

Public Sub MostrarRefereciasEnTableViewBibtexEnCurso(iRow As Integer)

  With FMain
    .idBibtex.Text = .gvReferenciasEnCurso[iRow, 0].Text
    .idArticuloBibtex.Text = .gvReferenciasEnCurso[iRow, 1].Text
    .idRevistaBibtex.Text = .gvReferenciasEnCurso[iRow, 2].Text
    .cmbTipoDeEntrada.Text = .gvReferenciasEnCurso[iRow, 3].Text
    .txtClaveBibtex.Text = .gvReferenciasEnCurso[iRow, 4].Text
    .cmbTipoDeTesis.Text = .gvReferenciasEnCurso[iRow, 5].Text
    .txtAuthor.Text = .gvReferenciasEnCurso[iRow, 6].Text
    .txtEditor.Text = .gvReferenciasEnCurso[iRow, 7].Text
    .txtTitle.Text = .gvReferenciasEnCurso[iRow, 8].Text
    .txtNameAddOn.Text = .gvReferenciasEnCurso[iRow, 9].Text
    .txtBookAuthor.Text = .gvReferenciasEnCurso[iRow, 10].Text
    .txtEditorA.Text = .gvReferenciasEnCurso[iRow, 11].Text
    .txtEditorB.Text = .gvReferenciasEnCurso[iRow, 12].Text
    .txtEditorC.Text = .gvReferenciasEnCurso[iRow, 13].Text
    .txtAfterword.Text = .gvReferenciasEnCurso[iRow, 14].Text
    .txtForeword.Text = .gvReferenciasEnCurso[iRow, 15].Text
    .txtCommentator.Text = .gvReferenciasEnCurso[iRow, 16].Text
    .txtIntroduction.Text = .gvReferenciasEnCurso[iRow, 17].Text
    .txtTranslator.Text = .gvReferenciasEnCurso[iRow, 18].Text
    .txtAnnotator.Text = .gvReferenciasEnCurso[iRow, 19].Text
    .txtHolder.Text = .gvReferenciasEnCurso[iRow, 20].Text
    .txtGender.Text = .gvReferenciasEnCurso[iRow, 21].Text
    .txtShortAuthor.Text = .gvReferenciasEnCurso[iRow, 22].Text
    .cmbEditorType.Text = .gvReferenciasEnCurso[iRow, 23].Text
    .cmbEditorTypeA.Text = .gvReferenciasEnCurso[iRow, 24].Text
    .cmbEditorTypeB.Text = .gvReferenciasEnCurso[iRow, 25].Text
    .cmbEditorTypeC.Text = .gvReferenciasEnCurso[iRow, 26].Text
    .txtTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 27].Text
    .txtSubTitle.Text = .gvReferenciasEnCurso[iRow, 28].Text
    .txtSeries.Text = .gvReferenciasEnCurso[iRow, 29].Text
    .txtBookTitle.Text = .gvReferenciasEnCurso[iRow, 30].Text
    .txtBookTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 31].Text
    .txtMainTitle.Text = .gvReferenciasEnCurso[iRow, 32].Text
    .txtMainTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 33].Text
    .txtJournalTitle.Text = .gvReferenciasEnCurso[iRow, 34].Text
    .txtJournalTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 35].Text
    .txtIssueTitle.Text = .gvReferenciasEnCurso[iRow, 36].Text
    .txtIssueTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 37].Text
    .txtEventTitle.Text = .gvReferenciasEnCurso[iRow, 38].Text
    .txtEventTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 39].Text
    .txtIndexTitle.Text = .gvReferenciasEnCurso[iRow, 40].Text
    .txtShortTitle.Text = .gvReferenciasEnCurso[iRow, 41].Text
    .txtReprintTitle.Text = .gvReferenciasEnCurso[iRow, 42].Text
    .txtVolume.Text = .gvReferenciasEnCurso[iRow, 43].Text
    .txtVolumes.Text = .gvReferenciasEnCurso[iRow, 44].Text
    .txtNumber.Text = .gvReferenciasEnCurso[iRow, 45].Text
    .txtChapter.Text = .gvReferenciasEnCurso[iRow, 46].Text
    .txtEid.Text = .gvReferenciasEnCurso[iRow, 47].Text
    .txtPart.Text = .gvReferenciasEnCurso[iRow, 48].Text
    .txtEdition.Text = .gvReferenciasEnCurso[iRow, 49].Text
    .txtIssue.Text = .gvReferenciasEnCurso[iRow, 50].Text
    .txtYear.Text = .gvReferenciasEnCurso[iRow, 51].Text
    .txtEventDate.Text = .gvReferenciasEnCurso[iRow, 52].Text
    .txtDate.Text = .gvReferenciasEnCurso[iRow, 53].Text
    .txtOrigDate.Text = .gvReferenciasEnCurso[iRow, 54].Text
    .txtUrlDate.Text = .gvReferenciasEnCurso[iRow, 55].Text
    .txtVersion.Text = .gvReferenciasEnCurso[iRow, 56].Text
    .cmbHyphenation.Text = .gvReferenciasEnCurso[iRow, 57].Text
    .cmbLanguage.Text = .gvReferenciasEnCurso[iRow, 58].Text
    .cmbOrigLanguage.Text = .gvReferenciasEnCurso[iRow, 59].Text
    .cmbLangId.Text = .gvReferenciasEnCurso[iRow, 60].Text
    .txtLandIdOpts.Text = .gvReferenciasEnCurso[iRow, 61].Text
    .cmbPubState.Text = .gvReferenciasEnCurso[iRow, 62].Text
    .txtPages.Text = .gvReferenciasEnCurso[iRow, 63].Text
    .txtPageTotal.Text = .gvReferenciasEnCurso[iRow, 64].Text
    .cmbPagination.Text = .gvReferenciasEnCurso[iRow, 65].Text
    .cmbBookPagination.Text = .gvReferenciasEnCurso[iRow, 66].Text
    .txtLocation.Text = .gvReferenciasEnCurso[iRow, 67].Text
    .txtOrigLocation.Text = .gvReferenciasEnCurso[iRow, 68].Text
    .txtInstitution.Text = .gvReferenciasEnCurso[iRow, 69].Text
    .txtOrganization.Text = .gvReferenciasEnCurso[iRow, 70].Text
    .txtPublisher.Text = .gvReferenciasEnCurso[iRow, 71].Text
    .txtOrigPublisher.Text = .gvReferenciasEnCurso[iRow, 72].Text
    .txtVenue.Text = .gvReferenciasEnCurso[iRow, 73].Text
    .txtEprint.Text = .gvReferenciasEnCurso[iRow, 74].Text
    .cmbEprintType.Text = .gvReferenciasEnCurso[iRow, 75].Text
    .txtUrl.Text = .gvReferenciasEnCurso[iRow, 76].Text
    .txtIsbn.Text = .gvReferenciasEnCurso[iRow, 77].Text
    .txtIssn.Text = .gvReferenciasEnCurso[iRow, 78].Text
    .txtIsmn.Text = .gvReferenciasEnCurso[iRow, 79].Text
    .txtIsrn.Text = .gvReferenciasEnCurso[iRow, 80].Text
    .txtIsan.Text = .gvReferenciasEnCurso[iRow, 81].Text
    .txtIswc.Text = .gvReferenciasEnCurso[iRow, 82].Text
    .txtDoi.Text = .gvReferenciasEnCurso[iRow, 83].Text
    .cmbRelatedType.Text = .gvReferenciasEnCurso[iRow, 84].Text
    .txtRelated.Text = .gvReferenciasEnCurso[iRow, 85].Text
    .txtRelatedString.Text = .gvReferenciasEnCurso[iRow, 86].Text
    .txtAddendum.Text = .gvReferenciasEnCurso[iRow, 87].Text
    .txtEntrySubType.Text = .gvReferenciasEnCurso[iRow, 88].Text
    .txtOptions.Text = .gvReferenciasEnCurso[iRow, 89].Text
    .txtLabel.Text = .gvReferenciasEnCurso[iRow, 90].Text
    .txtHowPublished.Text = .gvReferenciasEnCurso[iRow, 91].Text
    .txtShortHand.Text = .gvReferenciasEnCurso[iRow, 92].Text
    .txtShortHandIntro.Text = .gvReferenciasEnCurso[iRow, 93].Text
    .txtIds.Text = .gvReferenciasEnCurso[iRow, 94].Text
    .txtEntrySet.Text = .gvReferenciasEnCurso[iRow, 95].Text
    .txtCrossRef.Text = .gvReferenciasEnCurso[iRow, 96].Text
    .txtXref.Text = .gvReferenciasEnCurso[iRow, 97].Text
    .txtXdata.Text = .gvReferenciasEnCurso[iRow, 98].Text
    .txtPreSort.Text = .gvReferenciasEnCurso[iRow, 99].Text
    .txtSortKey.Text = .gvReferenciasEnCurso[iRow, 100].Text
    .txtSortName.Text = .gvReferenciasEnCurso[iRow, 101].Text
    .txtSortHand.Text = .gvReferenciasEnCurso[iRow, 102].Text
    .txtSortYear.Text = .gvReferenciasEnCurso[iRow, 103].Text
    .txtSortTitle.Text = .gvReferenciasEnCurso[iRow, 104].Text
    .txtIndexSortTitle.Text = .gvReferenciasEnCurso[iRow, 105].Text
    .txtAbstract.Text = .gvReferenciasEnCurso[iRow, 106].Text
    .txtNote.Text = .gvReferenciasEnCurso[iRow, 107].Text
    .txtLibrary.Text = .gvReferenciasEnCurso[iRow, 108].Text
    .txtAnnotation.Text = .gvReferenciasEnCurso[iRow, 109].Text
    .txtFile.Text = .gvReferenciasEnCurso[iRow, 110].Text

  End With

End

Public Sub AgregarClaveBib()

  Dim textoOrigen As String
  Dim posicion As Integer
  Dim cadenaTercerTextBox As String
  Dim cadenaCuartoTextBox As String
  Dim Header As String

  'prefijo de la clave bib
  Header = FMain.idBibtex.Text & "-"

  ' Obtén el texto del TextBox de origen
  If Trim(FMain.txtAuthor.Text) = "" Then
    ' Si el TextBox de origen está vacío, usa el contenido de otro TextBox
    textoOrigen = FMain.txtEditor.Text
  Else
    textoOrigen = FMain.txtAuthor.Text
  End If

  ' Encuentra la posición de la primera coma, punto, punto y coma  o espacio en el texto
  posicion = InStr(textoOrigen, ",")

  If posicion = 0 Then
    posicion = InStr(textoOrigen, ";")
  End If

  If posicion = 0 Then
    posicion = InStr(textoOrigen, ".")
  End If

  If posicion = 0 Then
    posicion = InStr(textoOrigen, " ")
  End If

  ' Si se encontró una coma, punto o espacio, copia el texto hasta esa posición
  If posicion > 0 Then
    textoOrigen = Left(textoOrigen, posicion - 1)
  End If

  ' Reemplaza caracteres problemáticos
  textoOrigen = Replace(textoOrigen, "´", "")
  textoOrigen = Replace(textoOrigen, "`", "")
  textoOrigen = Replace(textoOrigen, " ", "")
  textoOrigen = Replace(textoOrigen, "{", "")
  textoOrigen = Replace(textoOrigen, "}", "")
  textoOrigen = Replace(textoOrigen, "[", "")
  textoOrigen = Replace(textoOrigen, "]", "")
  textoOrigen = Replace(textoOrigen, "¿", "")
  textoOrigen = Replace(textoOrigen, "?", "")
  textoOrigen = Replace(textoOrigen, "¡", "")
  textoOrigen = Replace(textoOrigen, "!", "")
  textoOrigen = Replace(textoOrigen, "(", "")
  textoOrigen = Replace(textoOrigen, ")", "")
  textoOrigen = Replace(textoOrigen, "-", "")
  textoOrigen = Replace(textoOrigen, "_", "")
  textoOrigen = Replace(textoOrigen, "'", "")
  textoOrigen = Replace(textoOrigen, "#", "")
  textoOrigen = Replace(textoOrigen, "@", "")
  textoOrigen = Replace(textoOrigen, "/", "")
  textoOrigen = Replace(textoOrigen, "°", "")
  textoOrigen = Replace(textoOrigen, "~", "")
  textoOrigen = Replace(textoOrigen, "*", "")
  textoOrigen = Replace(textoOrigen, "+", "")

  textoOrigen = Replace(textoOrigen, "á", "A")
  textoOrigen = Replace(textoOrigen, "à", "A")
  textoOrigen = Replace(textoOrigen, "â", "A")
  textoOrigen = Replace(textoOrigen, "ä", "A")
  textoOrigen = Replace(textoOrigen, "ã", "A")
  textoOrigen = Replace(textoOrigen, "å", "A")
  textoOrigen = Replace(textoOrigen, "æ", "AE")
  textoOrigen = Replace(textoOrigen, "ā", "A")
  textoOrigen = Replace(textoOrigen, "ă", "A")
  textoOrigen = Replace(textoOrigen, "ą", "A")
  textoOrigen = Replace(textoOrigen, "ç", "C")
  textoOrigen = Replace(textoOrigen, "ć", "C")
  textoOrigen = Replace(textoOrigen, "č", "C")
  textoOrigen = Replace(textoOrigen, "ď", "D")
  textoOrigen = Replace(textoOrigen, "đ", "D")
  textoOrigen = Replace(textoOrigen, "é", "E")
  textoOrigen = Replace(textoOrigen, "è", "E")
  textoOrigen = Replace(textoOrigen, "ê", "E")
  textoOrigen = Replace(textoOrigen, "ë", "E")
  textoOrigen = Replace(textoOrigen, "ē", "E")
  textoOrigen = Replace(textoOrigen, "ė", "E")
  textoOrigen = Replace(textoOrigen, "ę", "E")
  textoOrigen = Replace(textoOrigen, "ě", "E")
  textoOrigen = Replace(textoOrigen, "í", "I")
  textoOrigen = Replace(textoOrigen, "ì", "I")
  textoOrigen = Replace(textoOrigen, "î", "I")
  textoOrigen = Replace(textoOrigen, "ï", "I")
  textoOrigen = Replace(textoOrigen, "ī", "I")
  textoOrigen = Replace(textoOrigen, "į", "I")
  textoOrigen = Replace(textoOrigen, "ı", "I")
  textoOrigen = Replace(textoOrigen, "ĺ", "L")
  textoOrigen = Replace(textoOrigen, "ľ", "L")
  textoOrigen = Replace(textoOrigen, "ł", "L")
  textoOrigen = Replace(textoOrigen, "ñ", "N")
  textoOrigen = Replace(textoOrigen, "ń", "N")
  textoOrigen = Replace(textoOrigen, "ň", "N")
  textoOrigen = Replace(textoOrigen, "ó", "O")
  textoOrigen = Replace(textoOrigen, "ò", "O")
  textoOrigen = Replace(textoOrigen, "ô", "O")
  textoOrigen = Replace(textoOrigen, "ö", "O")
  textoOrigen = Replace(textoOrigen, "õ", "O")
  textoOrigen = Replace(textoOrigen, "ő", "O")
  textoOrigen = Replace(textoOrigen, "ø", "O")
  textoOrigen = Replace(textoOrigen, "œ", "OE")
  textoOrigen = Replace(textoOrigen, "ŕ", "R")
  textoOrigen = Replace(textoOrigen, "ř", "R")
  textoOrigen = Replace(textoOrigen, "ś", "S")
  textoOrigen = Replace(textoOrigen, "š", "S")
  textoOrigen = Replace(textoOrigen, "ş", "S")
  textoOrigen = Replace(textoOrigen, "ș", "S")
  textoOrigen = Replace(textoOrigen, "ť", "T")
  textoOrigen = Replace(textoOrigen, "ţ", "T")
  textoOrigen = Replace(textoOrigen, "ț", "T")
  textoOrigen = Replace(textoOrigen, "ú", "U")
  textoOrigen = Replace(textoOrigen, "ù", "U")
  textoOrigen = Replace(textoOrigen, "û", "U")
  textoOrigen = Replace(textoOrigen, "ü", "U")
  textoOrigen = Replace(textoOrigen, "ū", "U")
  textoOrigen = Replace(textoOrigen, "ů", "U")
  textoOrigen = Replace(textoOrigen, "ű", "U")
  textoOrigen = Replace(textoOrigen, "ų", "U")
  textoOrigen = Replace(textoOrigen, "ý", "Y")
  textoOrigen = Replace(textoOrigen, "ÿ", "Y")
  textoOrigen = Replace(textoOrigen, "ź", "Z")
  textoOrigen = Replace(textoOrigen, "ż", "Z")
  textoOrigen = Replace(textoOrigen, "ž", "Z")

  ' Mayúsculas
  textoOrigen = Replace(textoOrigen, "Á", "A")
  textoOrigen = Replace(textoOrigen, "À", "A")
  textoOrigen = Replace(textoOrigen, "Â", "A")
  textoOrigen = Replace(textoOrigen, "Ä", "A")
  textoOrigen = Replace(textoOrigen, "Ã", "A")
  textoOrigen = Replace(textoOrigen, "Å", "A")
  textoOrigen = Replace(textoOrigen, "Æ", "AE")
  textoOrigen = Replace(textoOrigen, "Ā", "A")
  textoOrigen = Replace(textoOrigen, "Ă", "A")
  textoOrigen = Replace(textoOrigen, "Ą", "A")
  textoOrigen = Replace(textoOrigen, "Ç", "C")
  textoOrigen = Replace(textoOrigen, "Ć", "C")
  textoOrigen = Replace(textoOrigen, "Č", "C")
  textoOrigen = Replace(textoOrigen, "Ď", "D")
  textoOrigen = Replace(textoOrigen, "Đ", "D")
  textoOrigen = Replace(textoOrigen, "É", "E")
  textoOrigen = Replace(textoOrigen, "È", "E")
  textoOrigen = Replace(textoOrigen, "Ê", "E")
  textoOrigen = Replace(textoOrigen, "Ë", "E")
  textoOrigen = Replace(textoOrigen, "Ē", "E")
  textoOrigen = Replace(textoOrigen, "Ė", "E")
  textoOrigen = Replace(textoOrigen, "Ę", "E")
  textoOrigen = Replace(textoOrigen, "Ě", "E")
  textoOrigen = Replace(textoOrigen, "Í", "I")
  textoOrigen = Replace(textoOrigen, "Ì", "I")
  textoOrigen = Replace(textoOrigen, "Î", "I")
  textoOrigen = Replace(textoOrigen, "Ï", "I")
  textoOrigen = Replace(textoOrigen, "Ī", "I")
  textoOrigen = Replace(textoOrigen, "Į", "I")
  textoOrigen = Replace(textoOrigen, "İ", "I")
  textoOrigen = Replace(textoOrigen, "Ĺ", "L")
  textoOrigen = Replace(textoOrigen, "Ľ", "L")
  textoOrigen = Replace(textoOrigen, "Ł", "L")
  textoOrigen = Replace(textoOrigen, "Ñ", "N")
  textoOrigen = Replace(textoOrigen, "Ń", "N")
  textoOrigen = Replace(textoOrigen, "Ň", "N")
  textoOrigen = Replace(textoOrigen, "Ó", "O")
  textoOrigen = Replace(textoOrigen, "Ò", "O")
  textoOrigen = Replace(textoOrigen, "Ô", "O")
  textoOrigen = Replace(textoOrigen, "Ö", "O")
  textoOrigen = Replace(textoOrigen, "Õ", "O")
  textoOrigen = Replace(textoOrigen, "Ő", "O")
  textoOrigen = Replace(textoOrigen, "Ø", "O")
  textoOrigen = Replace(textoOrigen, "Œ", "OE")
  textoOrigen = Replace(textoOrigen, "Ŕ", "R")
  textoOrigen = Replace(textoOrigen, "Ř", "R")
  textoOrigen = Replace(textoOrigen, "Ś", "S")
  textoOrigen = Replace(textoOrigen, "Š", "S")
  textoOrigen = Replace(textoOrigen, "Ş", "S")
  textoOrigen = Replace(textoOrigen, "Ș", "S")
  textoOrigen = Replace(textoOrigen, "Ť", "T")
  textoOrigen = Replace(textoOrigen, "Ţ", "T")
  textoOrigen = Replace(textoOrigen, "Ț", "T")
  textoOrigen = Replace(textoOrigen, "Ú", "U")
  textoOrigen = Replace(textoOrigen, "Ù", "U")
  textoOrigen = Replace(textoOrigen, "Û", "U")
  textoOrigen = Replace(textoOrigen, "Ü", "U")
  textoOrigen = Replace(textoOrigen, "Ū", "U")
  textoOrigen = Replace(textoOrigen, "Ů", "U")
  textoOrigen = Replace(textoOrigen, "Ű", "U")
  textoOrigen = Replace(textoOrigen, "Ų", "U")
  textoOrigen = Replace(textoOrigen, "Ý", "Y")
  textoOrigen = Replace(textoOrigen, "Ÿ", "Y")
  textoOrigen = Replace(textoOrigen, "Ź", "Z")
  textoOrigen = Replace(textoOrigen, "Ż", "Z")
  textoOrigen = Replace(textoOrigen, "Ž", "Z")

  ' Adicionales
  textoOrigen = Replace(textoOrigen, "ẑ", "Z")
  textoOrigen = Replace(textoOrigen, "ž", "Z")
  textoOrigen = Replace(textoOrigen, "ẋ", "X")
  textoOrigen = Replace(textoOrigen, "ẍ", "X")
  textoOrigen = Replace(textoOrigen, "ṽ", "V")
  textoOrigen = Replace(textoOrigen, "ṕ", "P")
  textoOrigen = Replace(textoOrigen, "ṗ", "P")
  textoOrigen = Replace(textoOrigen, "ʠ", "Q")
  textoOrigen = Replace(textoOrigen, "ḿ", "M")
  textoOrigen = Replace(textoOrigen, "ṁ", "M")
  textoOrigen = Replace(textoOrigen, "ṃ", "M")
  textoOrigen = Replace(textoOrigen, "ĵ", "J")
  textoOrigen = Replace(textoOrigen, "ǰ", "J")
  textoOrigen = Replace(textoOrigen, "ḅ", "B")
  textoOrigen = Replace(textoOrigen, "ḃ", "B")
  textoOrigen = Replace(textoOrigen, "ḟ", "F")

  ' Elimina espacios al principio y al final
  textoOrigen = Trim(textoOrigen)

  ' Convierte el texto a mayúsculas
  textoOrigen = UCase(textoOrigen)

  ' Agregar el texto al final del TextBox de destino sin borrar su contenido actual
  FMain.txtClaveBibtex.Text = Header & textoOrigen

  ' Obtén el texto del tercer TextBox
  cadenaTercerTextBox = FMain.txtYear.Text
  cadenaTercerTextBox = Replace(cadenaTercerTextBox, "/", "")
  cadenaTercerTextBox = UCase(cadenaTercerTextBox)

  ' Verifica si el tercer TextBox está vacío
  If Trim(cadenaTercerTextBox) = "" Then
    ' Si el tercer TextBox está vacío, obtén el texto del cuarto TextBox
    cadenaCuartoTextBox = FMain.txtDate.Text
    cadenaCuartoTextBox = Replace(cadenaCuartoTextBox, "/", "")
    cadenaCuartoTextBox = UCase(cadenaCuartoTextBox)

    ' Verifica si el cuarto TextBox también está vacío
    If Trim(cadenaCuartoTextBox) = "" Then
      ' En caso de que ambos TextBox estén vacíos, agrega "-SINFECHA"
      FMain.txtClaveBibtex.Text = FMain.txtClaveBibtex.Text & "-SINFECHA"
    Else
      ' Si el cuarto TextBox no está vacío, toma los primeros 4 caracteres
      FMain.txtClaveBibtex.Text = FMain.txtClaveBibtex.Text & Left(cadenaCuartoTextBox, 4)
    End If
  Else
    ' Si el tercer TextBox no está vacío, toma los primeros 4 caracteres
    FMain.txtClaveBibtex.Text = FMain.txtClaveBibtex.Text & cadenaTercerTextBox '& Left(cadenaTercerTextBox, 4)
  End If

End

Public Sub RefrescarTableViewBibtexEnCurso()

  FMain.gvReferenciasEnCurso.Clear

  Dim rBibtex As Result
  Dim iRow As Integer
  Dim iCol As Integer

  rBibtex = m_OnOff_y_Red.meConn.Exec("SELECT * FROM bibtex WHERE id_revista = &1", FMain.idRevistaBibtex.Text)
  If rBibtex = Null Or rBibtex.Count = 0 Then Return

  FMain.gvReferenciasEnCurso.Columns.Count = rBibtex.Fields.Count
  FMain.gvReferenciasEnCurso.Rows.Count = rBibtex.Count
  FMain.gvReferenciasEnCurso.Refresh

  ' Poblar los datos del resultado en el GridView
  iRow = 0
  For Each rBibtex
    For iCol = 0 To rBibtex.Fields.Count - 1
      ' Acceso directo por índice con manejo de NULL
      If IsNull(rBibtex[iCol]) Then
        FMain.gvReferenciasEnCurso[iRow, iCol].Text = ""
      Else
        FMain.gvReferenciasEnCurso[iRow, iCol].Text = rBibtex[iCol]
      Endif
    Next
    iRow += 1
  Next

End

Public Sub LimpiarTextboxBibtex()

  FMain.txtAuthor.Text = ""
  FMain.txtTitle.Text = ""
  FMain.cmbTipoDeTesis.Text = ""
  FMain.txtClaveBibtex.Text = ""
  FMain.cmbTipoDeEntrada.Text = ""
  FMain.txtNameAddOn.Text = ""
  FMain.txtBookAuthor.Text = ""
  FMain.txtEditor.Text = ""
  FMain.txtEditorA.Text = ""
  FMain.txtEditorB.Text = ""
  FMain.txtEditorC.Text = ""
  FMain.txtAfterword.Text = ""
  FMain.txtForeword.Text = ""
  FMain.txtCommentator.Text = ""
  FMain.txtIntroduction.Text = ""
  FMain.txtTranslator.Text = ""
  FMain.txtAnnotator.Text = ""
  FMain.txtHolder.Text = ""
  FMain.txtGender.Text = ""
  FMain.txtShortAuthor.Text = ""
  FMain.cmbEditorType.Text = ""
  FMain.cmbEditorTypeA.Text = ""
  FMain.cmbEditorTypeB.Text = ""
  FMain.cmbEditorTypeC.Text = ""
  FMain.txtTitleAddOn.Text = ""
  FMain.txtSubTitle.Text = ""
  FMain.txtSeries.Text = ""
  FMain.txtBookTitle.Text = ""
  FMain.txtBookTitleAddOn.Text = ""
  FMain.txtMainTitle.Text = ""
  FMain.txtMainTitleAddOn.Text = ""
  FMain.txtJournalTitle.Text = ""
  FMain.txtJournalTitleAddOn.Text = ""
  FMain.txtIssueTitle.Text = ""
  FMain.txtIssueTitleAddOn.Text = ""
  FMain.txtEventTitle.Text = ""
  FMain.txtEventTitleAddOn.Text = ""
  FMain.txtIndexTitle.Text = ""
  FMain.txtShortTitle.Text = ""
  FMain.txtReprintTitle.Text = ""
  FMain.txtVolume.Text = ""
  FMain.txtVolumes.Text = ""
  FMain.txtNumber.Text = ""
  FMain.txtChapter.Text = ""
  FMain.txtEid.Text = ""
  FMain.txtPart.Text = ""
  FMain.txtEdition.Text = ""
  FMain.txtIssue.Text = ""
  FMain.txtYear.Text = ""
  FMain.txtEventDate.Text = ""
  FMain.txtDate.Text = ""
  FMain.txtOrigDate.Text = ""
  FMain.txtUrlDate.Text = ""
  FMain.txtVersion.Text = ""
  FMain.cmbHyphenation.Text = ""
  FMain.cmbLanguage.Text = ""
  FMain.cmbOrigLanguage.Text = ""
  FMain.cmbLangId.Text = ""
  FMain.txtLandIdOpts.Text = ""
  FMain.cmbPubState.Text = ""
  FMain.txtPages.Text = ""
  FMain.txtPageTotal.Text = ""
  FMain.cmbPagination.Text = ""
  FMain.cmbBookPagination.Text = ""
  FMain.txtLocation.Text = ""
  FMain.txtOrigLocation.Text = ""
  FMain.txtInstitution.Text = ""
  FMain.txtOrganization.Text = ""
  FMain.txtPublisher.Text = ""
  FMain.txtOrigPublisher.Text = ""
  FMain.txtVenue.Text = ""
  FMain.txtEprint.Text = ""
  FMain.cmbEprintType.Text = ""
  FMain.txtUrl.Text = ""
  FMain.txtIsbn.Text = ""
  FMain.txtIssn.Text = ""
  FMain.txtIsmn.Text = ""
  FMain.txtIsrn.Text = ""
  FMain.txtIsan.Text = ""
  FMain.txtIswc.Text = ""
  FMain.txtDoi.Text = ""
  FMain.cmbRelatedType.Text = ""
  FMain.txtRelated.Text = ""
  FMain.txtRelatedString.Text = ""
  FMain.txtAddendum.Text = ""
  FMain.txtEntrySubType.Text = ""
  FMain.txtOptions.Text = ""
  FMain.txtLabel.Text = ""
  FMain.txtHowPublished.Text = ""
  FMain.txtShortHand.Text = ""
  FMain.txtShortHandIntro.Text = ""
  FMain.txtIds.Text = ""
  FMain.txtEntrySet.Text = ""
  FMain.txtCrossRef.Text = ""
  FMain.txtXref.Text = ""
  FMain.txtXdata.Text = ""
  FMain.txtPreSort.Text = ""
  FMain.txtSortKey.Text = ""
  FMain.txtSortName.Text = ""
  FMain.txtSortHand.Text = ""
  FMain.txtSortYear.Text = ""
  FMain.txtSortTitle.Text = ""
  FMain.txtIndexSortTitle.Text = ""
  FMain.txtAbstract.Text = ""
  FMain.txtNote.Text = ""
  FMain.txtLibrary.Text = ""
  FMain.txtAnnotation.Text = ""
  FMain.txtFile.Text = ""

End

Public Sub GuardarCamposBib()

  ContenidoBib!id = CInt(FMain.idBibtex.Text)
  ContenidoBib!id_articulo = CInt(FMain.idArticuloBibtex.Text)
  ContenidoBib!id_revista = CInt(FMain.idRevistaBibtex.Text)
  ContenidoBib!txtAuthor = Trim(FMain.txtAuthor.Text)
  ContenidoBib!txtTitle = Trim(FMain.txtTitle.Text)
  ContenidoBib!cmbTipoDeTesis = FMain.cmbTipoDeTesis.Text
  ContenidoBib!txtClaveBibtex = Trim(FMain.txtClaveBibtex.Text)
  ContenidoBib!cmbTipoDeEntrada = FMain.cmbTipoDeEntrada.Text
  ContenidoBib!txtNameAddOn = Trim(FMain.txtNameAddOn.Text)
  ContenidoBib!txtBookAuthor = Trim(FMain.txtBookAuthor.Text)
  ContenidoBib!txtEditor = Trim(FMain.txtEditor.Text)
  ContenidoBib!txtEditorA = Trim(FMain.txtEditorA.Text)
  ContenidoBib!txtEditorB = Trim(FMain.txtEditorB.Text)
  ContenidoBib!txtEditorC = Trim(FMain.txtEditorC.Text)
  ContenidoBib!txtAfterword = Trim(FMain.txtAfterword.Text)
  ContenidoBib!txtForeword = Trim(FMain.txtForeword.Text)
  ContenidoBib!txtCommentator = Trim(FMain.txtCommentator.Text)
  ContenidoBib!txtIntroduction = Trim(FMain.txtIntroduction.Text)
  ContenidoBib!txtTranslator = Trim(FMain.txtTranslator.Text)
  ContenidoBib!txtAnnotator = Trim(FMain.txtAnnotator.Text)
  ContenidoBib!txtHolder = Trim(FMain.txtHolder.Text)
  ContenidoBib!txtGender = Trim(FMain.txtGender.Text)
  ContenidoBib!txtShortAuthor = Trim(FMain.txtShortAuthor.Text)
  ContenidoBib!cmbEditorType = FMain.cmbEditorType.Text
  ContenidoBib!cmbEditorTypeA = FMain.cmbEditorTypeA.Text
  ContenidoBib!cmbEditorTypeB = FMain.cmbEditorTypeB.Text
  ContenidoBib!cmbEditorTypeC = FMain.cmbEditorTypeC.Text
  ContenidoBib!txtTitleAddOn = Trim(FMain.txtTitleAddOn.Text)
  ContenidoBib!txtSubTitle = Trim(FMain.txtSubTitle.Text)
  ContenidoBib!txtSeries = Trim(FMain.txtSeries.Text)
  ContenidoBib!txtBookTitle = Trim(FMain.txtBookTitle.Text)
  ContenidoBib!txtBookTitleAddOn = Trim(FMain.txtBookTitleAddOn.Text)
  ContenidoBib!txtMainTitle = Trim(FMain.txtMainTitle.Text)
  ContenidoBib!txtMainTitleAddOn = Trim(FMain.txtMainTitleAddOn.Text)
  ContenidoBib!txtJournalTitle = Trim(FMain.txtJournalTitle.Text)
  ContenidoBib!txtJournalTitleAddOn = Trim(FMain.txtJournalTitleAddOn.Text)
  ContenidoBib!txtIssueTitle = Trim(FMain.txtIssueTitle.Text)
  ContenidoBib!txtIssueTitleAddOn = Trim(FMain.txtIssueTitleAddOn.Text)
  ContenidoBib!txtEventTitle = Trim(FMain.txtEventTitle.Text)
  ContenidoBib!txtEventTitleAddOn = Trim(FMain.txtEventTitleAddOn.Text)
  ContenidoBib!txtIndexTitle = Trim(FMain.txtIndexTitle.Text)
  ContenidoBib!txtShortTitle = Trim(FMain.txtShortTitle.Text)
  ContenidoBib!txtReprintTitle = Trim(FMain.txtReprintTitle.Text)
  ContenidoBib!txtVolume = Trim(FMain.txtVolume.Text)
  ContenidoBib!txtVolumes = Trim(FMain.txtVolumes.Text)
  ContenidoBib!txtNumber = Trim(FMain.txtNumber.Text)
  ContenidoBib!txtChapter = Trim(FMain.txtChapter.Text)
  ContenidoBib!txtEid = Trim(FMain.txtEid.Text)
  ContenidoBib!txtPart = Trim(FMain.txtPart.Text)
  ContenidoBib!txtEdition = Trim(FMain.txtEdition.Text)
  ContenidoBib!txtIssue = Trim(FMain.txtIssue.Text)
  ContenidoBib!txtYear = Trim(FMain.txtYear.Text)
  ContenidoBib!txtEventDate = Trim(FMain.txtEventDate.Text)
  ContenidoBib!txtDate = Trim(FMain.txtDate.Text)
  ContenidoBib!txtOrigDate = Trim(FMain.txtOrigDate.Text)
  ContenidoBib!txtUrlDate = Trim(FMain.txtUrlDate.Text)
  ContenidoBib!txtVersion = Trim(FMain.txtVersion.Text)
  ContenidoBib!cmbHyphenation = FMain.cmbHyphenation.Text
  ContenidoBib!cmbLanguage = FMain.cmbLanguage.Text
  ContenidoBib!cmbOrigLanguage = FMain.cmbOrigLanguage.Text
  ContenidoBib!cmbLangId = FMain.cmbLangId.Text
  ContenidoBib!txtLandIdOpts = Trim(FMain.txtLandIdOpts.Text)
  ContenidoBib!cmbPubState = FMain.cmbPubState.Text
  ContenidoBib!txtPages = Trim(FMain.txtPages.Text)
  ContenidoBib!txtPageTotal = Trim(FMain.txtPageTotal.Text)
  ContenidoBib!cmbPagination = FMain.cmbPagination.Text
  ContenidoBib!cmbBookPagination = FMain.cmbBookPagination.Text
  ContenidoBib!txtLocation = Trim(FMain.txtLocation.Text)
  ContenidoBib!txtOrigLocation = Trim(FMain.txtOrigLocation.Text)
  ContenidoBib!txtInstitution = Trim(FMain.txtInstitution.Text)
  ContenidoBib!txtOrganization = Trim(FMain.txtOrganization.Text)
  ContenidoBib!txtPublisher = Trim(FMain.txtPublisher.Text)
  ContenidoBib!txtOrigPublisher = Trim(FMain.txtOrigPublisher.Text)
  ContenidoBib!txtVenue = Trim(FMain.txtVenue.Text)
  ContenidoBib!txtEprint = Trim(FMain.txtEprint.Text)
  ContenidoBib!cmbEprintType = Trim(FMain.cmbEprintType.Text)
  ContenidoBib!txtUrl = Trim(FMain.txtUrl.Text)
  ContenidoBib!txtIsbn = Trim(FMain.txtIsbn.Text)
  ContenidoBib!txtIssn = Trim(FMain.txtIssn.Text)
  ContenidoBib!txtIsmn = Trim(FMain.txtIsmn.Text)
  ContenidoBib!txtIsrn = Trim(FMain.txtIsrn.Text)
  ContenidoBib!txtIsan = Trim(FMain.txtIsan.Text)
  ContenidoBib!txtIswc = Trim(FMain.txtIswc.Text)
  ContenidoBib!txtDoi = Trim(FMain.txtDoi.Text)
  ContenidoBib!cmbRelatedType = FMain.cmbRelatedType.Text
  ContenidoBib!txtRelated = Trim(FMain.txtRelated.Text)
  ContenidoBib!txtRelatedString = Trim(FMain.txtRelatedString.Text)
  ContenidoBib!txtAddendum = Trim(FMain.txtAddendum.Text)
  ContenidoBib!txtEntrySubType = Trim(FMain.txtEntrySubType.Text)
  ContenidoBib!txtOptions = Trim(FMain.txtOptions.Text)
  ContenidoBib!txtLabel = Trim(FMain.txtLabel.Text)
  ContenidoBib!txtHowPublished = Trim(FMain.txtHowPublished.Text)
  ContenidoBib!txtShortHand = Trim(FMain.txtShortHand.Text)
  ContenidoBib!txtShortHandIntro = Trim(FMain.txtShortHandIntro.Text)
  ContenidoBib!txtIds = Trim(FMain.txtIds.Text)
  ContenidoBib!txtEntrySet = Trim(FMain.txtEntrySet.Text)
  ContenidoBib!txtCrossRef = Trim(FMain.txtCrossRef.Text)
  ContenidoBib!txtXref = Trim(FMain.txtXref.Text)
  ContenidoBib!txtXdata = Trim(FMain.txtXdata.Text)
  ContenidoBib!txtPreSort = Trim(FMain.txtPreSort.Text)
  ContenidoBib!txtSortKey = Trim(FMain.txtSortKey.Text)
  ContenidoBib!txtSortName = Trim(FMain.txtSortName.Text)
  ContenidoBib!txtSortHand = Trim(FMain.txtSortHand.Text)
  ContenidoBib!txtSortYear = Trim(FMain.txtSortYear.Text)
  ContenidoBib!txtSortTitle = Trim(FMain.txtSortTitle.Text)
  ContenidoBib!txtIndexSortTitle = Trim(FMain.txtIndexSortTitle.Text)
  ContenidoBib!txtAbstract = Trim(FMain.txtAbstract.Text)
  ContenidoBib!txtNote = Trim(FMain.txtNote.Text)
  ContenidoBib!txtLibrary = Trim(FMain.txtLibrary.Text)
  ContenidoBib!txtAnnotation = Trim(FMain.txtAnnotation.Text)
  ContenidoBib!txtFile = Trim(FMain.txtFile.Text)

End

Public Sub GuardarBibtexPrimeraVez()

  ContenidoBib = m_OnOff_y_Red.meConn.Create("bibtex")

  GuardarCamposBib()
  ContenidoBib.Update
  m_OnOff_y_Red.meConn.Commit()
  RefrescarTableViewBibtexEnCurso()
  FMain.gvReferenciasEnCurso.Refresh

  Message.Info("La referencia se guardó con éxito.")

Catch
  Message.Error("Error al intentar guardar la entrada: " & Error.Text)

End

Public Sub GuardarCambiosBibtex()

  ContenidoBib = m_OnOff_y_Red.meConn.Edit("bibtex", "id=" & FMain.idBibtex.Text)

  If Not ContenidoBib.Available Then
    Message.Error("No se encontró la referencia para editar.")
    Return
  Endif

  GuardarCamposBib()
  ContenidoBib.Update
  m_OnOff_y_Red.meConn.Commit()

  RefrescarTableViewBibtexEnCurso()
  Message.Info("Cambios guardados correctamente.")

Catch
  Message.Error("Error al guardar los cambios: " & Error.Text)

End
