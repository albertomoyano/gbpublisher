' Gambas class file

Public Sub btnAceptar_Click()

  Dim sTipo As String = Trim(txtNuevoTipo.Text)
  Dim rs As Result

  ' Validar texto
  If sTipo = "" Then
    Message.Warning("Debe ingresar un nombre para el tópico.")
    Return
  End If

  ' ' Verificar si ya existe (insensible a mayúsculas)
  ' rs = m_OnOff_y_Red.meConn.Exec("SELECT id FROM tipos WHERE LOWER(nombre) = LOWER(&1)", sTipo)

  If rs.Available Then
    Message.Warning("Ese tipo ya existe.")
    Return
  End If

  ' ' Insertar como tipo personalizado
  ' Try m_OnOff_y_Red.meConn.Exec("INSERT INTO tipos (nombre, predeterminado) VALUES (&1, &2)", sTipo, False)

  If Error Then
    Message.Error("No se pudo guardar el tópico. " & Error.Text)
  Else
    Me.Close
  End If

End
