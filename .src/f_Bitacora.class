' Gambas class file

Public Function BitacoraPorDefecto() As String[]

  Return ["Datos generales", "Recepción y evaluación preliminar", "Asignación de revisores", "Revisión por pares", "Decisión editorial", "Revisión de autores", "Edición y corrección de estilo", "Maquetación y pruebas", "Publicación", "Archivos y preservación", "Notas adicionales", "Control de tiempos"]

End

Public Sub SplitterBitacora_Resize()

  SplitterBitacora.Layout = [1, 1]

End

Public Sub Form_Open()

  SplitterBitacora.Layout = [1, 1]
  ListBoxTipos.Clear

  '   Dim tipo As String
  '   Dim rsTipo As Result
  '
  '   For Each tipo In BitacoraPorDefecto()
  '     rsTipo = m_ConexionBD.mConn.Exec("SELECT id FROM tipos WHERE nombre = &1", tipo)
  '
  '     If Not rsTipo.Available Then
  '       m_ConexionBD.mConn.Exec("INSERT INTO tipos (nombre, predeterminado) VALUES (&1, &2)", tipo, True)
  '     End If
  '   Next
  '
  '   ' Cargar todos los tipos
  '   Dim rs As Result = m_ConexionBD.mConn.Exec("SELECT nombre FROM tipos ORDER BY nombre")
  '   While rs.Available
  '     ListBoxTipos.Add(rs["nombre"])
  '     rs.MoveNext
  '   Wend
  '
  SplitterBitacora.Layout = [1, 1]

End

Public Sub btnCerrar_Click()

  Me.Close

End
